(()=>{"use strict";var e={169:(e,t,o)=>{o.d(t,{h:()=>s});var r=o(725);class s extends r.h{constructor(e="Karsai autó",t="",o=800){super(),this.prev=document.querySelector("div.form-popup"),this.prev&&this.prev.classList.add("back"),this.root=document.createElement("div"),this.root.classList.add("form-popup"),this.root.style.width=`${o}px`,this.root.style.zIndex=`${this.maxZIndex+1}`,this.layer=document.createElement("div"),this.layer.classList.add("form-popup-layer"),document.body.appendChild(this.layer),this.layer.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(this.root),this.root.style.zIndex=(this.maxZIndex+1).toString();const r=new MutationObserver((()=>{const e=this.root.querySelector("div.close-box");e&&(e.onclick=()=>this.close(),e.style.cursor="pointer",this.form=this.root.querySelector("form"),r.disconnect()),requestAnimationFrame((()=>this.root.classList.add("active")))}));r.observe(this.root,{childList:!0})}close(){return new Promise((e=>{this.root.ontransitionend=t=>{"top"!=t.propertyName&&"border-bottom-color"!=t.propertyName||(this.root.remove(),this.layer.remove(),document.querySelectorAll("section").forEach((e=>e.classList.remove("blur"))),document.querySelectorAll("nav").forEach((e=>e.classList.remove("blur"))),e(),this.prev&&this.prev.classList.remove("back"))},this.root.classList.remove("active")}))}}},725:(e,t,o)=>{o.d(t,{h:()=>r});class r{url(e){return`${(window.location.origin+window.location.pathname).replace(/\/+$/,"")}/${e}`}get schema(){return{model:{id:"id",fields:{}},data:e=>e.data||[],total:e=>e.total||0}}input(e){return document.getElementById(e)??document.createElement("button")}isMobile(){return window.innerWidth<=768||/Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent)}message(e){const t=Array.from(document.querySelectorAll("div.message-box")).reduce((e=>e+90),50),o=document.createElement("div");o.classList.add("message-box");const r=(new Date).toLocaleTimeString("hu-HU",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});o.style.zIndex=(this.maxZIndex+1).toString(),o.innerHTML=e+"&nbsp;"+r,o.style.top=`${t}px`,document.body.appendChild(o),o.ontransitionend=()=>{},requestAnimationFrame((()=>o.classList.add("active"))),o.onclick=()=>{o.ontransitionend=()=>o.remove(),o.classList.remove("active")},setTimeout((()=>{o.ontransitionend=()=>o.remove(),o.classList.remove("active")}),5e3)}showFormError(e,t,o){t.querySelectorAll("div.error-box").forEach((e=>e.remove()));for(const[r,s]of Object.entries(o)){const o=t.querySelector(`div.field-${e}-${r}`);console.log({model:e,key:r});const n=document.createElement("div");n.classList.add("error-box"),n.style.zIndex=(this.maxZIndex+1).toString(),n.innerHTML=s[0],o&&(o.appendChild(n),requestAnimationFrame((()=>n.classList.add("show"))))}}gridButtonList(e,t){return Array.from(e.wrapper[0].querySelectorAll(`button.${t}`)).map((t=>{const o=t.closest("tr");return{button:t,row:o,data:e.dataItem(o)}}))}async fetchDelete(e,t){const o=await fetch(`${e}/${t}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-Token":yii.getCsrfToken()}});let r;try{r=await o.json()}catch(e){r=null}if(200==o.status)return r;throw new Error(r?.message||"Sikertelen törlés")}async fetchForm(e,t,o=null,r=null,s=!0){return new Promise((n=>{const a=Array.from(document.querySelectorAll("div.form-popup"));if(a){const e=document.createElement("div");e.classList.add("loader"),e.style.zIndex=(this.maxZIndex+1).toString(),e.innerHTML='˛<img alt="nincs" src="/images/YTup.gif">',a[a.length-1]?.appendChild(e)}const i=[200,201,202],l=document.createElement("div");let d;s&&(l.classList.add("popup-layer"),document.body.appendChild(l),l.classList.add("animate"),l.style.zIndex=(this.maxZIndex+1).toString()),t.append("_csrf",yii.getCsrfToken()),fetch(e,{method:"POST",body:t}).then((e=>{if(l&&(l.remove(),document.querySelectorAll("div.loader").forEach((e=>e.remove()))),d=e.status,(e.headers.get("Content-Type")||"").includes("application/json"))return e.json();throw new Error("A válasz nem JSON formátumú.")})).then((e=>{i.includes(d)?n(e):r&&o&&this.showFormError(r,o,e.errors)}))}))}async fetchData(e,t={},o=!0){const r=jQuery.Deferred(),s=new FormData,n=document.createElement("div");o&&(n.classList.add("popup-layer"),n.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(n),n.classList.add("animate")),s.append("_csrf",yii.getCsrfToken());for(const[e,o]of Object.entries(t))s.append(e,o);const a=await fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest"},body:s,method:"POST"});if(403==a.status)return alert(await a.text()),document.querySelectorAll("div.form-popup-layer").forEach((e=>e.remove())),document.querySelectorAll("div.form-popup").forEach((e=>e.remove())),n&&n.remove(),!1;let i;const l=a.headers.get("content-type");return i="string"==typeof l&&l.includes("application/json")?await a.json():await a.text(),n&&n.remove(),r.resolve(i),r}urlPart(e){return`${new URL(window.location.href).pathname}/${e}`}get transport(){const e={};return e._csrf=yii.getCsrfToken(),{read:{type:"POST",url:null,data:e,dataType:"json"}}}confirm(e,t){const o=jQuery.Deferred(),r=jQuery(t).kendoPopover({body:()=>`<div class="confirm-body"><div>${e}</div><div><button class="btn btn-primary btn" data-name="no-btn">Nem</button><button class="btn btn-danger btn" data-name="yes-btn">Igen</button></div></div>`,position:"left",header:()=>"Megerősítés",showOn:"click",show:e=>{const t=e.sender.popup.element?.[0]?.querySelector('button[data-name="no-btn"]');t&&(t.onclick=()=>{e.sender.hide()});const r=e.sender.popup.element?.[0]?.querySelector('button[data-name="yes-btn"]');r&&(r.onclick=()=>{o.resolve(),e.sender.hide()})},hide:()=>{document.body.querySelectorAll("div.confirm-body").forEach((e=>{e.closest("div.k-animation-container")?.remove()}))}}).data("kendoPopover");return r&&r.show(),o}button(e){return document.getElementById(e)}div(e){return document.getElementById(e)}async delete(e,t){const o=new URL(window.location.origin+"/"+this.pascalToKebab(e));o.searchParams.append("id",t.toString());try{const e=await fetch(o.toString(),{method:"DELETE",headers:{"X-CSRF-Token":yii.getCsrfToken(),Accept:"application/json"}}),t=await e.json();return e.ok||console.error("Hiba a válaszban:",t.message||"Ismeretlen hiba történt."),t}catch(e){throw console.error("DELETE hiba:",e.message),e}}get maxZIndex(){let e=0;const t=document.getElementsByTagName("*");for(let o=0;o<t.length;o++){const r=window.getComputedStyle(t[o]).zIndex,s=parseInt(r,10);isNaN(s)||(e=Math.max(e,s))}return e}navigate(e,t="_self"){const o=document.createElement("a");o.href=e,document.body.appendChild(o),o.target=t,o.click(),o.remove()}pascalToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}grid(e,t,o=!0,r=[]){return new Promise((s=>{const n=this.schema,a=this.transport;a.read.url=t;const i=new kendo.data.DataSource({pageSize:100,transport:a,schema:n}),l=jQuery(e).kendoGrid({columns:r,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},autoBind:o}).data("kendoGrid");if(!l)throw new Error("Failed to initialize kendoGrid.");o?l.bind("dataBound",(()=>s(l))):s(l)}))}igenNemFilter(e,t){jQuery(e).kendoDropDownList({dataValueField:"id",dataTextField:"value",optionLabel:"-----------",dataSource:new kendo.data.DataSource({data:JSON.parse(t.dataset.igennemFilter)})})}get filterable(){return{extra:!1,operators:{string:{contains:"Tartalmazza",eq:"Egyenlő"}}}}dataBound(e,t,o=!0){e.bind("dataBound",t),o&&t()}}}},t={};function o(r){var s=t[r];if(void 0!==s)return s.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r,s,n,a=o(725),i=o(169);!function(e){e.AUTO_DETAIL="AutoDetail",e.EMAIL_FORM="EmailForm"}(r||(r={}));class l extends a.h{url(e){return`/index/${e}`}constructor(e){super(),this.autoId=0,this.popup=null,console.log(e),this.autoId=e}get carViewPopup(){return this.popup}async showDetail(e=!1){let t=this.url(r.AUTO_DETAIL);if(e){const e=new URL(t,window.location.origin);e.searchParams.set("admin","1"),t=e.toString()}const o=Math.min(1200,document.body.offsetWidth),s=new i.h("","",o);this.popup=s,s.root.innerHTML=await this.fetchData(t,{id:this.autoId}),document.querySelectorAll("section").forEach((e=>e.classList.add("blur"))),document.querySelectorAll("nav").forEach((e=>e.classList.add("blur")));const n=document.querySelector("div.form-popup-layer");n.style.cursor="pointer",n.onclick=()=>s.close();const a=window.scrollY+50;s.root.classList.add("fixed"),s.root.style.setProperty("--ypos",`${a}px`),this.initElements()}initElements(e=!1){const t=document.querySelectorAll(".simple-slider .slide");let o=0;t[o].classList.add("active");const r=this.div("thumb-slider"),s=this.div("counter-box");if(s.innerHTML=`1/${t.length}`,e){const e=this.div("detail-box");e.classList.remove("shadow-lg"),document.querySelector("div.close-box").remove(),document.querySelector("div.adatok-box").classList.add("bg-light"),e.style.border="none"}const n=e=>{t.forEach((e=>e.classList.remove("active"))),o=e,s.innerHTML=`${e+1}/${t.length}`,t[o].classList.add("active"),r.scrollTo({left:r.children[o].offsetLeft-r.offsetLeft,behavior:"smooth"})},a=this.button("prev-btn");this.button("next-btn").onclick=()=>n(Math.min(o+1,t.length-1)),a.onclick=()=>n(Math.max(o-1,0)),Array.from(r.querySelectorAll("div.thumb-slide")).forEach((e=>{e.onclick=()=>{const t=Array.from(e.parentElement.children).indexOf(e);n(t)}})),r.onwheel=e=>{0!==e.deltaY&&(e.preventDefault(),r.scrollLeft+=Math.trunc(e.deltaY))},this.button("email-btn").onclick=()=>{console.log(this.autoId),this.kapcsolatForm({autoId:this.autoId})}}async kapcsolatForm(e={}){const t=this.div("detail-box"),o=this.div("close-slide-box"),s=this.div("popup-slide-content-box"),n=this.url(r.EMAIL_FORM);s.innerHTML=await this.fetchData(n,e),t.classList.add("slide-in"),o.onclick=()=>{t.classList.remove("slide-in")},setTimeout((()=>{s.scrollIntoView({behavior:"smooth"})}),500),this.button("kuldes-btn").onclick=async()=>{const e=document.getElementById("uzenet-form"),o=new FormData(e),r=await this.fetchForm(n,o);r.success?(this.message(r.message),t.addEventListener("transitionend",(()=>s.innerHTML=""),{once:!0}),t.classList.remove("slide-in")):this.showFormError("kapcsolatmodel",e,JSON.parse(r.errors.toString()))}}}!function(e){e.AKCIOS_DATASOURCE="AkciosDatasource",e.SAVE_FILTER="SaveFilter",e[e.TYPE_AKCIOS=1]="TYPE_AKCIOS",e[e.TYPE_KIEMELT=2]="TYPE_KIEMELT"}(s||(s={})),function(e){e.JARMUVEK_FILTER_DATA_SOURCE="JarmuvekFilterDataSource",e.FILTER_EVENT="FilterEvent"}(n||(n={}));class d extends a.h{url(e){return`/index/${e}`}async init(){const e=this.div("jarmuvek-pager-1"),t=this.div("jarmuvek-pager-2"),o=await this.jarmuvekList(this.div("jarmuvek-list"),e,t);this.dataBound(o,(()=>{const r=o,s=r.content[0];0==r.dataSource.data().length?(s.classList.add("empty"),s.innerHTML='<div><i class="fa-solid fa-truck"></i><span>Sajnos nincs a keresésnek megfelelő jármű</span></div>'):s.classList.remove("empty"),e.style.display=0==r.dataSource.data().length?"none":"flex",t.style.display=0==r.dataSource.data().length?"none":"flex",Array.from(r.wrapper[0].querySelectorAll("div.autok-list-item")).forEach((e=>{const t=r.dataItem(e);e.onclick=()=>{this.isMobile()||new l(t.id).showDetail()}}))})),document.addEventListener(n.FILTER_EVENT,(async()=>{const e=document.getElementById("filter-form"),t=new FormData(e),r=this.url(s.SAVE_FILTER);await this.fetchForm(r,t),o.dataSource.page(1)})),this.initKeresesBox()}initKeresesBox(){const e=this.button("save-filter-btn"),t=this.button("reset-filter-btn");this.filterSelectIdList.forEach((e=>{jQuery(this.input(e)).kendoDropDownList({filter:"contains",height:400,valueTemplate:e=>{let t=`<div class="filter-template"><span class="label">${e.text}</span></div>`;return e.value&&(t=`<div class="filter-template"><span>${e.text}</span><span class="label">${e.parent()[0].text}</span></div>`),t}})}));const o=this.div("bovitett-kereses-box"),r=Array.from(document.querySelectorAll("button.remove-filter-btn")).map((e=>{const t=e.closest("div.hozzad-row");return{button:e,dropdown:jQuery(t.querySelector("select")).data("kendoDropDownList")}}));r.forEach((e=>{e.button.onclick=()=>{e.dropdown.value("");const t=new CustomEvent(n.FILTER_EVENT);document.dispatchEvent(t)}})),Array.from(document.querySelectorAll(".kereses-header i")).forEach((e=>{e.onclick=()=>{o.classList.toggle("open"),localStorage.setItem("bovitett-kereses-box",o.classList.contains("open")?"1":"0")}})),1==parseInt(localStorage.getItem("bovitett-kereses-box")||"0")&&setTimeout((()=>o.classList.add("open")),500),e.onclick=async()=>{const e=new CustomEvent(n.FILTER_EVENT);document.dispatchEvent(e)},t.onclick=()=>{r.forEach((e=>e.dropdown.value("")));const e=new CustomEvent(n.FILTER_EVENT);document.dispatchEvent(e)}}get filterSelectIdList(){return["filtermodel-marka","filtermodel-evjarat","filtermodel-vetelar","filtermodel-jarmutipus","filtermodel-motortipus","filtermodel-valto","filtermodel-teljesitmeny","filtermodel-kilometer","filtermodel-sorbarendezes","filtermodel-szin","filtermodel-kivitel","filtermodel-ajtokszama","filtermodel-szallithatoszemelyek","filtermodel-sajattomeg","filtermodel-ossztomeg","filtermodel-terhelhetoseg","filtermodel-tengelytav","filtermodel-szelesseg","filtermodel-hosszusag","filtermodel-hengerek_szama","filtermodel-hengerurtartalom"]}jarmuvekList(e,t,o){return new Promise((r=>{const s=this.url(n.JARMUVEK_FILTER_DATA_SOURCE),a=this.schema,i=this.transport;i.read.url=s;const l=new kendo.data.DataSource({pageSize:30,transport:i,schema:a,serverPaging:!0});jQuery(e).kendoListView({template:e=>e.template,dataSource:l,dataBound:e=>r(e.sender)}),jQuery(t).kendoPager({responsive:!0,refresh:!0,dataSource:l}),jQuery(o).kendoPager({responsive:!0,refresh:!0,dataSource:l,change:()=>{const e=document.querySelector("nav.navbar"),t=document.querySelector("section.hero"),o=e.offsetHeight+t.offsetHeight-40;window.scrollTo({top:o,behavior:"smooth"})}})}))}}(new d).init()})();