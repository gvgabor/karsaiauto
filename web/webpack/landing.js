(()=>{"use strict";var e={725:(e,t,n)=>{n.d(t,{h:()=>o});class o{url(e){return`${(window.location.origin+window.location.pathname).replace(/\/+$/,"")}/${e}`}get schema(){return{model:{id:"id",fields:{}},data:e=>e.data||[],total:e=>e.total||0}}input(e){return document.getElementById(e)??document.createElement("button")}message(e){const t=Array.from(document.querySelectorAll("div.message-box")).reduce((e=>e+90),50),n=document.createElement("div");n.classList.add("message-box");const o=(new Date).toLocaleTimeString("hu-HU",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});n.style.zIndex=(this.maxZIndex+1).toString(),n.innerHTML=e+"&nbsp;"+o,n.style.top=`${t}px`,document.body.appendChild(n),n.ontransitionend=()=>{},requestAnimationFrame((()=>n.classList.add("active"))),n.onclick=()=>{n.ontransitionend=()=>n.remove(),n.classList.remove("active")},setTimeout((()=>{n.ontransitionend=()=>n.remove(),n.classList.remove("active")}),3e3)}showFormError(e,t,n){t.querySelectorAll("div.error-box").forEach((e=>e.remove()));for(const[o,a]of Object.entries(n)){const n=t.querySelector(`div.field-${e}-${o}`),r=document.createElement("div");r.classList.add("error-box"),r.style.zIndex=(this.maxZIndex+1).toString(),r.innerHTML=a[0],n&&(n.appendChild(r),requestAnimationFrame((()=>r.classList.add("show"))))}}gridButtonList(e,t){return Array.from(e.wrapper[0].querySelectorAll(`button.${t}`)).map((t=>{const n=t.closest("tr");return{button:t,row:n,data:e.dataItem(n)}}))}async fetchDelete(e,t){const n=await fetch(`${e}/${t}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-Token":yii.getCsrfToken()}});let o;try{o=await n.json()}catch(e){o=null}if(200==n.status)return o;throw new Error(o?.message||"Sikertelen törlés")}async fetchForm(e,t,n=null,o=null,a=!0){return new Promise((r=>{const s=document.querySelector("div.form-popup");if(s){const e=document.createElement("div");e.classList.add("loader"),e.style.zIndex=(this.maxZIndex+1).toString(),e.innerHTML='˛<img alt="nincs" src="/images/YTup.gif">',s.appendChild(e)}const i=[200,201,202],d=document.createElement("div");let c;a&&(d.classList.add("popup-layer"),d.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(d),d.classList.add("animate")),t.append("_csrf",yii.getCsrfToken()),fetch(e,{method:"POST",body:t}).then((e=>{if(d&&(d.remove(),document.querySelectorAll("div.loader").forEach((e=>e.remove()))),c=e.status,(e.headers.get("Content-Type")||"").includes("application/json"))return e.json();throw new Error("A válasz nem JSON formátumú.")})).then((e=>{i.includes(c)?r(e):o&&n&&this.showFormError(o,n,e.errors)}))}))}async fetchData(e,t={},n=!0){const o=jQuery.Deferred(),a=new FormData,r=document.createElement("div");n&&(r.classList.add("popup-layer"),r.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(r),r.classList.add("animate")),a.append("_csrf",yii.getCsrfToken());for(const[e,n]of Object.entries(t))a.append(e,n);const s=await fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest"},body:a,method:"POST"});if(403==s.status)return alert(await s.text()),document.querySelectorAll("div.form-popup-layer").forEach((e=>e.remove())),document.querySelectorAll("div.form-popup").forEach((e=>e.remove())),r&&r.remove(),!1;let i;const d=s.headers.get("content-type");return i="string"==typeof d&&d.includes("application/json")?await s.json():await s.text(),r&&r.remove(),o.resolve(i),o}urlPart(e){return`${new URL(window.location.href).pathname}/${e}`}get transport(){const e={};return e._csrf=yii.getCsrfToken(),{read:{type:"POST",url:null,data:e,dataType:"json"}}}confirm(e,t){const n=jQuery.Deferred(),o=jQuery(t).kendoPopover({body:()=>`<div class="confirm-body"><div>${e}</div><div><button class="btn btn-primary btn" data-name="no-btn">Nem</button><button class="btn btn-danger btn" data-name="yes-btn">Igen</button></div></div>`,position:"left",header:()=>"Megerősítés",showOn:"click",show:e=>{const t=e.sender.popup.element?.[0]?.querySelector('button[data-name="no-btn"]');t&&(t.onclick=()=>{e.sender.hide()});const o=e.sender.popup.element?.[0]?.querySelector('button[data-name="yes-btn"]');o&&(o.onclick=()=>{n.resolve(),e.sender.hide()})},hide:()=>{document.body.querySelectorAll("div.confirm-body").forEach((e=>{e.closest("div.k-animation-container")?.remove()}))}}).data("kendoPopover");return o&&o.show(),n}button(e){return document.getElementById(e)}div(e){return document.getElementById(e)}async delete(e,t){const n=new URL(window.location.origin+"/"+this.pascalToKebab(e));n.searchParams.append("id",t.toString());try{const e=await fetch(n.toString(),{method:"DELETE",headers:{"X-CSRF-Token":yii.getCsrfToken(),Accept:"application/json"}}),t=await e.json();return e.ok||console.error("Hiba a válaszban:",t.message||"Ismeretlen hiba történt."),t}catch(e){throw console.error("DELETE hiba:",e.message),e}}get maxZIndex(){let e=0;const t=document.getElementsByTagName("*");for(let n=0;n<t.length;n++){const o=window.getComputedStyle(t[n]).zIndex,a=parseInt(o,10);isNaN(a)||(e=Math.max(e,a))}return e}navigate(e,t="_self"){const n=document.createElement("a");n.href=e,document.body.appendChild(n),n.target=t,n.click(),n.remove()}pascalToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}grid(e,t,n=!0,o=[]){return new Promise((a=>{const r=this.schema,s=this.transport;s.read.url=t;const i=new kendo.data.DataSource({pageSize:100,transport:s,schema:r}),d=jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},autoBind:n}).data("kendoGrid");if(!d)throw new Error("Failed to initialize kendoGrid.");n?d.bind("dataBound",(()=>a(d))):a(d)}))}igenNemFilter(e,t){jQuery(e).kendoDropDownList({dataValueField:"id",dataTextField:"value",optionLabel:"-----------",dataSource:new kendo.data.DataSource({data:JSON.parse(t.dataset.igennemFilter)})})}get filterable(){return{extra:!1,operators:{string:{contains:"Tartalmazza",eq:"Egyenlő"}}}}dataBound(e,t,n=!0){e.bind("dataBound",t),n&&t()}}}},t={};function n(o){var a=t[o];if(void 0!==a)return a.exports;var r=t[o]={exports:{}};return e[o](r,r.exports,n),r.exports}n.d=(e,t)=>{for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var o,a=n(725);!function(e){e.AKCIOS_DATASOURCE="AkciosDatasource",e.SAVE_FILTER="SaveFilter",e[e.TYPE_AKCIOS=1]="TYPE_AKCIOS",e[e.TYPE_KIEMELT=2]="TYPE_KIEMELT"}(o||(o={}));class r extends a.h{async init(){["filtermodel-marka","filtermodel-evjarat","filtermodel-vetelar"].forEach((e=>{jQuery(this.input(e)).kendoDropDownList({filter:"contains",height:400})}));const e=await this.akciosAutokList(this.div("akcios-autok-list"),o.TYPE_AKCIOS);console.log("=>(class.landing.ts:22) akciosAutokList",e);const t=await this.akciosAutokList(this.div("kiemelt-autok-list"),o.TYPE_KIEMELT),n=document.getElementById("kiemelt-autok-label"),a=document.getElementById("akcios-autok-label");this.dataBound(t,(()=>{const e=t;n.style.display=0==e.dataSource.data().length?"none":"block"})),this.dataBound(e,(()=>{const t=e;a.style.display=0==t.dataSource.data().length?"none":"block"})),this.button("save-filter-btn").onclick=async()=>{const e=document.getElementById("filter-form"),t=new FormData(e),n=this.url(o.SAVE_FILTER),a=await this.fetchForm(n,t);this.navigate(a.url)}}url(e){return`/index/${e}`}akciosAutokList(e,t){return new Promise((n=>{const a=this.url(o.AKCIOS_DATASOURCE),r=this.schema,s=this.transport;s.read.url=a,s.read.data.type=t;const i=new kendo.data.DataSource({pageSize:100,transport:s,schema:r});jQuery(e).kendoListView({template:e=>e.template,dataSource:i,dataBound:e=>n(e.sender)})}))}}(new r).init()})();