(()=>{"use strict";var e={169:(e,t,a)=>{a.d(t,{h:()=>n});var r=a(725);class n extends r.h{constructor(e="Karsai autó",t="",a=800){super(),this.prev=document.querySelector("div.form-popup"),this.prev&&this.prev.classList.add("back"),this.root=document.createElement("div"),this.root.classList.add("form-popup"),this.root.style.width=`${a}px`,this.root.style.zIndex=`${this.maxZIndex+1}`,this.layer=document.createElement("div"),this.layer.classList.add("form-popup-layer"),document.body.appendChild(this.layer),this.layer.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(this.root),this.root.style.zIndex=(this.maxZIndex+1).toString();const r=new MutationObserver((()=>{const e=this.root.querySelector("div.close-box");e&&(e.onclick=()=>this.close(),e.style.cursor="pointer",this.form=this.root.querySelector("form"),r.disconnect()),requestAnimationFrame((()=>this.root.classList.add("active")))}));r.observe(this.root,{childList:!0})}close(){return new Promise((e=>{this.root.ontransitionend=t=>{"top"!=t.propertyName&&"border-bottom-color"!=t.propertyName||(this.root.remove(),this.layer.remove(),document.querySelectorAll("section").forEach((e=>e.classList.remove("blur"))),document.querySelectorAll("nav").forEach((e=>e.classList.remove("blur"))),e(),this.prev&&this.prev.classList.remove("back"))},this.root.classList.remove("active")}))}}},725:(e,t,a)=>{a.d(t,{h:()=>r});class r{url(e){return`${(window.location.origin+window.location.pathname).replace(/\/+$/,"")}/${e}`}get schema(){return{model:{id:"id",fields:{}},data:e=>e.data||[],total:e=>e.total||0}}input(e){return document.getElementById(e)??document.createElement("button")}message(e){const t=Array.from(document.querySelectorAll("div.message-box")).reduce((e=>e+90),50),a=document.createElement("div");a.classList.add("message-box");const r=(new Date).toLocaleTimeString("hu-HU",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});a.style.zIndex=(this.maxZIndex+1).toString(),a.innerHTML=e+"&nbsp;"+r,a.style.top=`${t}px`,document.body.appendChild(a),a.ontransitionend=()=>{},requestAnimationFrame((()=>a.classList.add("active"))),a.onclick=()=>{a.ontransitionend=()=>a.remove(),a.classList.remove("active")},setTimeout((()=>{a.ontransitionend=()=>a.remove(),a.classList.remove("active")}),3e3)}showFormError(e,t,a){t.querySelectorAll("div.error-box").forEach((e=>e.remove()));for(const[r,n]of Object.entries(a)){const a=t.querySelector(`div.field-${e}-${r}`);console.log({model:e,key:r});const i=document.createElement("div");i.classList.add("error-box"),i.style.zIndex=(this.maxZIndex+1).toString(),i.innerHTML=n[0],a&&(a.appendChild(i),requestAnimationFrame((()=>i.classList.add("show"))))}}gridButtonList(e,t){return Array.from(e.wrapper[0].querySelectorAll(`button.${t}`)).map((t=>{const a=t.closest("tr");return{button:t,row:a,data:e.dataItem(a)}}))}async fetchDelete(e,t){const a=await fetch(`${e}/${t}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-Token":yii.getCsrfToken()}});let r;try{r=await a.json()}catch(e){r=null}if(200==a.status)return r;throw new Error(r?.message||"Sikertelen törlés")}async fetchForm(e,t,a=null,r=null,n=!0){return new Promise((i=>{const o=Array.from(document.querySelectorAll("div.form-popup"));if(o){const e=document.createElement("div");e.classList.add("loader"),e.style.zIndex=(this.maxZIndex+1).toString(),e.innerHTML='˛<img alt="nincs" src="/images/YTup.gif">',o[o.length-1]?.appendChild(e)}const s=[200,201,202],l=document.createElement("div");let d;n&&(l.classList.add("popup-layer"),document.body.appendChild(l),l.classList.add("animate"),l.style.zIndex=(this.maxZIndex+1).toString()),t.append("_csrf",yii.getCsrfToken()),fetch(e,{method:"POST",body:t}).then((e=>{if(l&&(l.remove(),document.querySelectorAll("div.loader").forEach((e=>e.remove()))),d=e.status,(e.headers.get("Content-Type")||"").includes("application/json"))return e.json();throw new Error("A válasz nem JSON formátumú.")})).then((e=>{s.includes(d)?i(e):r&&a&&this.showFormError(r,a,e.errors)}))}))}async fetchData(e,t={},a=!0){const r=jQuery.Deferred(),n=new FormData,i=document.createElement("div");a&&(i.classList.add("popup-layer"),i.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(i),i.classList.add("animate")),n.append("_csrf",yii.getCsrfToken());for(const[e,a]of Object.entries(t))n.append(e,a);const o=await fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest"},body:n,method:"POST"});if(403==o.status)return alert(await o.text()),document.querySelectorAll("div.form-popup-layer").forEach((e=>e.remove())),document.querySelectorAll("div.form-popup").forEach((e=>e.remove())),i&&i.remove(),!1;let s;const l=o.headers.get("content-type");return s="string"==typeof l&&l.includes("application/json")?await o.json():await o.text(),i&&i.remove(),r.resolve(s),r}urlPart(e){return`${new URL(window.location.href).pathname}/${e}`}get transport(){const e={};return e._csrf=yii.getCsrfToken(),{read:{type:"POST",url:null,data:e,dataType:"json"}}}confirm(e,t){const a=jQuery.Deferred(),r=jQuery(t).kendoPopover({body:()=>`<div class="confirm-body"><div>${e}</div><div><button class="btn btn-primary btn" data-name="no-btn">Nem</button><button class="btn btn-danger btn" data-name="yes-btn">Igen</button></div></div>`,position:"left",header:()=>"Megerősítés",showOn:"click",show:e=>{const t=e.sender.popup.element?.[0]?.querySelector('button[data-name="no-btn"]');t&&(t.onclick=()=>{e.sender.hide()});const r=e.sender.popup.element?.[0]?.querySelector('button[data-name="yes-btn"]');r&&(r.onclick=()=>{a.resolve(),e.sender.hide()})},hide:()=>{document.body.querySelectorAll("div.confirm-body").forEach((e=>{e.closest("div.k-animation-container")?.remove()}))}}).data("kendoPopover");return r&&r.show(),a}button(e){return document.getElementById(e)}div(e){return document.getElementById(e)}async delete(e,t){const a=new URL(window.location.origin+"/"+this.pascalToKebab(e));a.searchParams.append("id",t.toString());try{const e=await fetch(a.toString(),{method:"DELETE",headers:{"X-CSRF-Token":yii.getCsrfToken(),Accept:"application/json"}}),t=await e.json();return e.ok||console.error("Hiba a válaszban:",t.message||"Ismeretlen hiba történt."),t}catch(e){throw console.error("DELETE hiba:",e.message),e}}get maxZIndex(){let e=0;const t=document.getElementsByTagName("*");for(let a=0;a<t.length;a++){const r=window.getComputedStyle(t[a]).zIndex,n=parseInt(r,10);isNaN(n)||(e=Math.max(e,n))}return e}navigate(e,t="_self"){const a=document.createElement("a");a.href=e,document.body.appendChild(a),a.target=t,a.click(),a.remove()}pascalToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}grid(e,t,a=!0,r=[]){return new Promise((n=>{const i=this.schema,o=this.transport;o.read.url=t;const s=new kendo.data.DataSource({pageSize:100,transport:o,schema:i}),l=jQuery(e).kendoGrid({columns:r,dataSource:s,filterable:this.filterable,height:"100%",pageable:{refresh:!0},autoBind:a}).data("kendoGrid");if(!l)throw new Error("Failed to initialize kendoGrid.");a?l.bind("dataBound",(()=>n(l))):n(l)}))}igenNemFilter(e,t){jQuery(e).kendoDropDownList({dataValueField:"id",dataTextField:"value",optionLabel:"-----------",dataSource:new kendo.data.DataSource({data:JSON.parse(t.dataset.igennemFilter)})})}get filterable(){return{extra:!1,operators:{string:{contains:"Tartalmazza",eq:"Egyenlő"}}}}dataBound(e,t,a=!0){e.bind("dataBound",t),a&&t()}}}},t={};function a(r){var n=t[r];if(void 0!==n)return n.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,a),i.exports}a.d=(e,t)=>{for(var r in t)a.o(t,r)&&!a.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},a.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var r=a(725),n=a(169),i="undefined"!=typeof window?window:void 0!==a.g?a.g:"undefined"!=typeof self?self:{},o=function(e,t,a,r,n,i,s,l,d,c){var u=this;u.numeralDecimalMark=e||".",u.numeralIntegerScale=t>0?t:0,u.numeralDecimalScale=a>=0?a:2,u.numeralThousandsGroupStyle=r||o.groupStyle.thousand,u.numeralPositiveOnly=!!n,u.stripLeadingZeroes=!1!==i,u.prefix=s||""===s?s:"",u.signBeforePrefix=!!l,u.tailPrefix=!!d,u.delimiter=c||""===c?c:",",u.delimiterRE=c?new RegExp("\\"+c,"g"):""};o.groupStyle={thousand:"thousand",lakh:"lakh",wan:"wan",none:"none"},o.prototype={getRawValue:function(e){return e.replace(this.delimiterRE,"").replace(this.numeralDecimalMark,".")},format:function(e){var t,a,r,n,i=this,s="";switch(e=e.replace(/[A-Za-z]/g,"").replace(i.numeralDecimalMark,"M").replace(/[^\dM-]/g,"").replace(/^\-/,"N").replace(/\-/g,"").replace("N",i.numeralPositiveOnly?"":"-").replace("M",i.numeralDecimalMark),i.stripLeadingZeroes&&(e=e.replace(/^(-)?0+(?=\d)/,"$1")),a="-"===e.slice(0,1)?"-":"",r=void 0!==i.prefix?i.signBeforePrefix?a+i.prefix:i.prefix+a:a,n=e,e.indexOf(i.numeralDecimalMark)>=0&&(n=(t=e.split(i.numeralDecimalMark))[0],s=i.numeralDecimalMark+t[1].slice(0,i.numeralDecimalScale)),"-"===a&&(n=n.slice(1)),i.numeralIntegerScale>0&&(n=n.slice(0,i.numeralIntegerScale)),i.numeralThousandsGroupStyle){case o.groupStyle.lakh:n=n.replace(/(\d)(?=(\d\d)+\d$)/g,"$1"+i.delimiter);break;case o.groupStyle.wan:n=n.replace(/(\d)(?=(\d{4})+$)/g,"$1"+i.delimiter);break;case o.groupStyle.thousand:n=n.replace(/(\d)(?=(\d{3})+$)/g,"$1"+i.delimiter)}return i.tailPrefix?a+n.toString()+(i.numeralDecimalScale>0?s.toString():"")+i.prefix:r+n.toString()+(i.numeralDecimalScale>0?s.toString():"")}};var s=o,l=function(e,t,a){var r=this;r.date=[],r.blocks=[],r.datePattern=e,r.dateMin=t.split("-").reverse().map((function(e){return parseInt(e,10)})),2===r.dateMin.length&&r.dateMin.unshift(0),r.dateMax=a.split("-").reverse().map((function(e){return parseInt(e,10)})),2===r.dateMax.length&&r.dateMax.unshift(0),r.initBlocks()};l.prototype={initBlocks:function(){var e=this;e.datePattern.forEach((function(t){"Y"===t?e.blocks.push(4):e.blocks.push(2)}))},getISOFormatDate:function(){var e=this,t=e.date;return t[2]?t[2]+"-"+e.addLeadingZero(t[1])+"-"+e.addLeadingZero(t[0]):""},getBlocks:function(){return this.blocks},getValidatedDate:function(e){var t=this,a="";return e=e.replace(/[^\d]/g,""),t.blocks.forEach((function(r,n){if(e.length>0){var i=e.slice(0,r),o=i.slice(0,1),s=e.slice(r);switch(t.datePattern[n]){case"d":"00"===i?i="01":parseInt(o,10)>3?i="0"+o:parseInt(i,10)>31&&(i="31");break;case"m":"00"===i?i="01":parseInt(o,10)>1?i="0"+o:parseInt(i,10)>12&&(i="12")}a+=i,e=s}})),this.getFixedDateString(a)},getFixedDateString:function(e){var t,a,r,n=this,i=n.datePattern,o=[],s=0,l=0,d=0,c=0,u=0,m=0,h=!1;return 4===e.length&&"y"!==i[0].toLowerCase()&&"y"!==i[1].toLowerCase()&&(u=2-(c="d"===i[0]?0:2),t=parseInt(e.slice(c,c+2),10),a=parseInt(e.slice(u,u+2),10),o=this.getFixedDate(t,a,0)),8===e.length&&(i.forEach((function(e,t){switch(e){case"d":s=t;break;case"m":l=t;break;default:d=t}})),m=2*d,c=s<=d?2*s:2*s+2,u=l<=d?2*l:2*l+2,t=parseInt(e.slice(c,c+2),10),a=parseInt(e.slice(u,u+2),10),r=parseInt(e.slice(m,m+4),10),h=4===e.slice(m,m+4).length,o=this.getFixedDate(t,a,r)),4!==e.length||"y"!==i[0]&&"y"!==i[1]||(m=2-(u="m"===i[0]?0:2),a=parseInt(e.slice(u,u+2),10),r=parseInt(e.slice(m,m+2),10),h=2===e.slice(m,m+2).length,o=[0,a,r]),6!==e.length||"Y"!==i[0]&&"Y"!==i[1]||(m=2-.5*(u="m"===i[0]?0:4),a=parseInt(e.slice(u,u+2),10),r=parseInt(e.slice(m,m+4),10),h=4===e.slice(m,m+4).length,o=[0,a,r]),o=n.getRangeFixedDate(o),n.date=o,0===o.length?e:i.reduce((function(e,t){switch(t){case"d":return e+(0===o[0]?"":n.addLeadingZero(o[0]));case"m":return e+(0===o[1]?"":n.addLeadingZero(o[1]));case"y":return e+(h?n.addLeadingZeroForYear(o[2],!1):"");case"Y":return e+(h?n.addLeadingZeroForYear(o[2],!0):"")}}),"")},getRangeFixedDate:function(e){var t=this,a=t.datePattern,r=t.dateMin||[],n=t.dateMax||[];return!e.length||r.length<3&&n.length<3||a.find((function(e){return"y"===e.toLowerCase()}))&&0===e[2]?e:n.length&&(n[2]<e[2]||n[2]===e[2]&&(n[1]<e[1]||n[1]===e[1]&&n[0]<e[0]))?n:r.length&&(r[2]>e[2]||r[2]===e[2]&&(r[1]>e[1]||r[1]===e[1]&&r[0]>e[0]))?r:e},getFixedDate:function(e,t,a){return e=Math.min(e,31),t=Math.min(t,12),a=parseInt(a||0,10),(t<7&&t%2==0||t>8&&t%2==1)&&(e=Math.min(e,2===t?this.isLeapYear(a)?29:28:30)),[e,t,a]},isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},addLeadingZero:function(e){return(e<10?"0":"")+e},addLeadingZeroForYear:function(e,t){return t?(e<10?"000":e<100?"00":e<1e3?"0":"")+e:(e<10?"0":"")+e}};var d=l,c=function(e,t){var a=this;a.time=[],a.blocks=[],a.timePattern=e,a.timeFormat=t,a.initBlocks()};c.prototype={initBlocks:function(){var e=this;e.timePattern.forEach((function(){e.blocks.push(2)}))},getISOFormatTime:function(){var e=this,t=e.time;return t[2]?e.addLeadingZero(t[0])+":"+e.addLeadingZero(t[1])+":"+e.addLeadingZero(t[2]):""},getBlocks:function(){return this.blocks},getTimeFormatOptions:function(){return"12"===String(this.timeFormat)?{maxHourFirstDigit:1,maxHours:12,maxMinutesFirstDigit:5,maxMinutes:60}:{maxHourFirstDigit:2,maxHours:23,maxMinutesFirstDigit:5,maxMinutes:60}},getValidatedTime:function(e){var t=this,a="";e=e.replace(/[^\d]/g,"");var r=t.getTimeFormatOptions();return t.blocks.forEach((function(n,i){if(e.length>0){var o=e.slice(0,n),s=o.slice(0,1),l=e.slice(n);switch(t.timePattern[i]){case"h":parseInt(s,10)>r.maxHourFirstDigit?o="0"+s:parseInt(o,10)>r.maxHours&&(o=r.maxHours+"");break;case"m":case"s":parseInt(s,10)>r.maxMinutesFirstDigit?o="0"+s:parseInt(o,10)>r.maxMinutes&&(o=r.maxMinutes+"")}a+=o,e=l}})),this.getFixedTimeString(a)},getFixedTimeString:function(e){var t,a,r,n=this,i=n.timePattern,o=[],s=0,l=0,d=0,c=0,u=0,m=0;return 6===e.length&&(i.forEach((function(e,t){switch(e){case"s":s=2*t;break;case"m":l=2*t;break;case"h":d=2*t}})),m=d,u=l,c=s,t=parseInt(e.slice(c,c+2),10),a=parseInt(e.slice(u,u+2),10),r=parseInt(e.slice(m,m+2),10),o=this.getFixedTime(r,a,t)),4===e.length&&n.timePattern.indexOf("s")<0&&(i.forEach((function(e,t){switch(e){case"m":l=2*t;break;case"h":d=2*t}})),m=d,u=l,t=0,a=parseInt(e.slice(u,u+2),10),r=parseInt(e.slice(m,m+2),10),o=this.getFixedTime(r,a,t)),n.time=o,0===o.length?e:i.reduce((function(e,t){switch(t){case"s":return e+n.addLeadingZero(o[2]);case"m":return e+n.addLeadingZero(o[1]);case"h":return e+n.addLeadingZero(o[0])}}),"")},getFixedTime:function(e,t,a){return a=Math.min(parseInt(a||0,10),60),t=Math.min(t,60),[e=Math.min(e,60),t,a]},addLeadingZero:function(e){return(e<10?"0":"")+e}};var u=c,m=function(e,t){var a=this;a.delimiter=t||""===t?t:" ",a.delimiterRE=t?new RegExp("\\"+t,"g"):"",a.formatter=e};m.prototype={setFormatter:function(e){this.formatter=e},format:function(e){var t=this;t.formatter.clear();for(var a,r="",n=!1,i=0,o=(e=(e=(e=e.replace(/[^\d+]/g,"")).replace(/^\+/,"B").replace(/\+/g,"").replace("B","+")).replace(t.delimiterRE,"")).length;i<o;i++)a=t.formatter.inputDigit(e.charAt(i)),/[\s()-]/g.test(a)?(r=a,n=!0):n||(r=a);return(r=r.replace(/[()]/g,"")).replace(/[\s-]/g,t.delimiter)}};var h=m,p={blocks:{uatp:[4,5,6],amex:[4,6,5],diners:[4,6,4],discover:[4,4,4,4],mastercard:[4,4,4,4],dankort:[4,4,4,4],instapayment:[4,4,4,4],jcb15:[4,6,5],jcb:[4,4,4,4],maestro:[4,4,4,4],visa:[4,4,4,4],mir:[4,4,4,4],unionPay:[4,4,4,4],general:[4,4,4,4]},re:{uatp:/^(?!1800)1\d{0,14}/,amex:/^3[47]\d{0,13}/,discover:/^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,diners:/^3(?:0([0-5]|9)|[689]\d?)\d{0,11}/,mastercard:/^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,dankort:/^(5019|4175|4571)\d{0,12}/,instapayment:/^63[7-9]\d{0,13}/,jcb15:/^(?:2131|1800)\d{0,11}/,jcb:/^(?:35\d{0,2})\d{0,12}/,maestro:/^(?:5[0678]\d{0,2}|6304|67\d{0,2})\d{0,12}/,mir:/^220[0-4]\d{0,12}/,visa:/^4\d{0,15}/,unionPay:/^(62|81)\d{0,14}/},getStrictBlocks:function(e){var t=e.reduce((function(e,t){return e+t}),0);return e.concat(19-t)},getInfo:function(e,t){var a=p.blocks,r=p.re;for(var n in t=!!t,r)if(r[n].test(e)){var i=a[n];return{type:n,blocks:t?this.getStrictBlocks(i):i}}return{type:"unknown",blocks:t?this.getStrictBlocks(a.general):a.general}}},g=p,f={noop:function(){},strip:function(e,t){return e.replace(t,"")},getPostDelimiter:function(e,t,a){if(0===a.length)return e.slice(-t.length)===t?t:"";var r="";return a.forEach((function(t){e.slice(-t.length)===t&&(r=t)})),r},getDelimiterREByDelimiter:function(e){return new RegExp(e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g")},getNextCursorPosition:function(e,t,a,r,n){return t.length===e?a.length:e+this.getPositionOffset(e,t,a,r,n)},getPositionOffset:function(e,t,a,r,n){var i,o,s;return i=this.stripDelimiters(t.slice(0,e),r,n),o=this.stripDelimiters(a.slice(0,e),r,n),0!==(s=i.length-o.length)?s/Math.abs(s):0},stripDelimiters:function(e,t,a){var r=this;if(0===a.length){var n=t?r.getDelimiterREByDelimiter(t):"";return e.replace(n,"")}return a.forEach((function(t){t.split("").forEach((function(t){e=e.replace(r.getDelimiterREByDelimiter(t),"")}))})),e},headStr:function(e,t){return e.slice(0,t)},getMaxLength:function(e){return e.reduce((function(e,t){return e+t}),0)},getPrefixStrippedValue:function(e,t,a,r,n,i,o,s,l){if(0===a)return e;if(e===t&&""!==e)return"";if(l&&"-"==e.slice(0,1)){var d="-"==r.slice(0,1)?r.slice(1):r;return"-"+this.getPrefixStrippedValue(e.slice(1),t,a,d,n,i,o,s,l)}if(r.slice(0,a)!==t&&!s)return o&&!r&&e?e:"";if(r.slice(-a)!==t&&s)return o&&!r&&e?e:"";var c=this.stripDelimiters(r,n,i);return e.slice(0,a)===t||s?e.slice(-a)!==t&&s?c.slice(0,-a-1):s?e.slice(0,-a):e.slice(a):c.slice(a)},getFirstDiffIndex:function(e,t){for(var a=0;e.charAt(a)===t.charAt(a);)if(""===e.charAt(a++))return-1;return a},getFormattedValue:function(e,t,a,r,n,i){var o="",s=n.length>0,l="";return 0===a?e:(t.forEach((function(t,d){if(e.length>0){var c=e.slice(0,t),u=e.slice(t);l=s?n[i?d-1:d]||l:r,i?(d>0&&(o+=l),o+=c):(o+=c,c.length===t&&d<a-1&&(o+=l)),e=u}})),o)},fixPrefixCursor:function(e,t,a,r){if(e){var n=e.value,i=a||r[0]||" ";if(e.setSelectionRange&&t&&!(t.length+i.length<=n.length)){var o=2*n.length;setTimeout((function(){e.setSelectionRange(o,o)}),1)}}},checkFullSelection:function(e){try{return(window.getSelection()||document.getSelection()||{}).toString().length===e.length}catch(e){}return!1},setSelection:function(e,t,a){if(e===this.getActiveElement(a)&&!(e&&e.value.length<=t))if(e.createTextRange){var r=e.createTextRange();r.move("character",t),r.select()}else try{e.setSelectionRange(t,t)}catch(e){console.warn("The input element type does not support selection")}},getActiveElement:function(e){var t=e.activeElement;return t&&t.shadowRoot?this.getActiveElement(t.shadowRoot):t},isAndroid:function(){return navigator&&/android/i.test(navigator.userAgent)},isAndroidBackspaceKeydown:function(e,t){return!!(this.isAndroid()&&e&&t)&&t===e.slice(0,-1)}},y={assign:function(e,t){return t=t||{},(e=e||{}).creditCard=!!t.creditCard,e.creditCardStrictMode=!!t.creditCardStrictMode,e.creditCardType="",e.onCreditCardTypeChanged=t.onCreditCardTypeChanged||function(){},e.phone=!!t.phone,e.phoneRegionCode=t.phoneRegionCode||"AU",e.phoneFormatter={},e.time=!!t.time,e.timePattern=t.timePattern||["h","m","s"],e.timeFormat=t.timeFormat||"24",e.timeFormatter={},e.date=!!t.date,e.datePattern=t.datePattern||["d","m","Y"],e.dateMin=t.dateMin||"",e.dateMax=t.dateMax||"",e.dateFormatter={},e.numeral=!!t.numeral,e.numeralIntegerScale=t.numeralIntegerScale>0?t.numeralIntegerScale:0,e.numeralDecimalScale=t.numeralDecimalScale>=0?t.numeralDecimalScale:2,e.numeralDecimalMark=t.numeralDecimalMark||".",e.numeralThousandsGroupStyle=t.numeralThousandsGroupStyle||"thousand",e.numeralPositiveOnly=!!t.numeralPositiveOnly,e.stripLeadingZeroes=!1!==t.stripLeadingZeroes,e.signBeforePrefix=!!t.signBeforePrefix,e.tailPrefix=!!t.tailPrefix,e.swapHiddenInput=!!t.swapHiddenInput,e.numericOnly=e.creditCard||e.date||!!t.numericOnly,e.uppercase=!!t.uppercase,e.lowercase=!!t.lowercase,e.prefix=e.creditCard||e.date?"":t.prefix||"",e.noImmediatePrefix=!!t.noImmediatePrefix,e.prefixLength=e.prefix.length,e.rawValueTrimPrefix=!!t.rawValueTrimPrefix,e.copyDelimiter=!!t.copyDelimiter,e.initValue=void 0!==t.initValue&&null!==t.initValue?t.initValue.toString():"",e.delimiter=t.delimiter||""===t.delimiter?t.delimiter:t.date?"/":t.time?":":t.numeral?",":(t.phone," "),e.delimiterLength=e.delimiter.length,e.delimiterLazyShow=!!t.delimiterLazyShow,e.delimiters=t.delimiters||[],e.blocks=t.blocks||[],e.blocksLength=e.blocks.length,e.root="object"==typeof i&&i?i:window,e.document=t.document||e.root.document,e.maxLength=0,e.backspace=!1,e.result="",e.onValueChanged=t.onValueChanged||function(){},e}},v=function(e,t){var a=this,r=!1;if("string"==typeof e?(a.element=document.querySelector(e),r=document.querySelectorAll(e).length>1):void 0!==e.length&&e.length>0?(a.element=e[0],r=e.length>1):a.element=e,!a.element)throw new Error("[cleave.js] Please check the element");if(r)try{console.warn("[cleave.js] Multiple input fields matched, cleave.js will only take the first one.")}catch(e){}t.initValue=a.element.value,a.properties=v.DefaultProperties.assign({},t),a.init()};v.prototype={init:function(){var e=this,t=e.properties;t.numeral||t.phone||t.creditCard||t.time||t.date||0!==t.blocksLength||t.prefix?(t.maxLength=v.Util.getMaxLength(t.blocks),e.isAndroid=v.Util.isAndroid(),e.lastInputValue="",e.isBackward="",e.onChangeListener=e.onChange.bind(e),e.onKeyDownListener=e.onKeyDown.bind(e),e.onFocusListener=e.onFocus.bind(e),e.onCutListener=e.onCut.bind(e),e.onCopyListener=e.onCopy.bind(e),e.initSwapHiddenInput(),e.element.addEventListener("input",e.onChangeListener),e.element.addEventListener("keydown",e.onKeyDownListener),e.element.addEventListener("focus",e.onFocusListener),e.element.addEventListener("cut",e.onCutListener),e.element.addEventListener("copy",e.onCopyListener),e.initPhoneFormatter(),e.initDateFormatter(),e.initTimeFormatter(),e.initNumeralFormatter(),(t.initValue||t.prefix&&!t.noImmediatePrefix)&&e.onInput(t.initValue)):e.onInput(t.initValue)},initSwapHiddenInput:function(){var e=this;if(e.properties.swapHiddenInput){var t=e.element.cloneNode(!0);e.element.parentNode.insertBefore(t,e.element),e.elementSwapHidden=e.element,e.elementSwapHidden.type="hidden",e.element=t,e.element.id=""}},initNumeralFormatter:function(){var e=this.properties;e.numeral&&(e.numeralFormatter=new v.NumeralFormatter(e.numeralDecimalMark,e.numeralIntegerScale,e.numeralDecimalScale,e.numeralThousandsGroupStyle,e.numeralPositiveOnly,e.stripLeadingZeroes,e.prefix,e.signBeforePrefix,e.tailPrefix,e.delimiter))},initTimeFormatter:function(){var e=this.properties;e.time&&(e.timeFormatter=new v.TimeFormatter(e.timePattern,e.timeFormat),e.blocks=e.timeFormatter.getBlocks(),e.blocksLength=e.blocks.length,e.maxLength=v.Util.getMaxLength(e.blocks))},initDateFormatter:function(){var e=this.properties;e.date&&(e.dateFormatter=new v.DateFormatter(e.datePattern,e.dateMin,e.dateMax),e.blocks=e.dateFormatter.getBlocks(),e.blocksLength=e.blocks.length,e.maxLength=v.Util.getMaxLength(e.blocks))},initPhoneFormatter:function(){var e=this.properties;if(e.phone)try{e.phoneFormatter=new v.PhoneFormatter(new e.root.Cleave.AsYouTypeFormatter(e.phoneRegionCode),e.delimiter)}catch(e){throw new Error("[cleave.js] Please include phone-type-formatter.{country}.js lib")}},onKeyDown:function(e){var t=this,a=e.which||e.keyCode;t.lastInputValue=t.element.value,t.isBackward=8===a},onChange:function(e){var t=this,a=t.properties,r=v.Util;t.isBackward=t.isBackward||"deleteContentBackward"===e.inputType;var n=r.getPostDelimiter(t.lastInputValue,a.delimiter,a.delimiters);t.isBackward&&n?a.postDelimiterBackspace=n:a.postDelimiterBackspace=!1,this.onInput(this.element.value)},onFocus:function(){var e=this,t=e.properties;e.lastInputValue=e.element.value,t.prefix&&t.noImmediatePrefix&&!e.element.value&&this.onInput(t.prefix),v.Util.fixPrefixCursor(e.element,t.prefix,t.delimiter,t.delimiters)},onCut:function(e){v.Util.checkFullSelection(this.element.value)&&(this.copyClipboardData(e),this.onInput(""))},onCopy:function(e){v.Util.checkFullSelection(this.element.value)&&this.copyClipboardData(e)},copyClipboardData:function(e){var t,a=this.properties,r=v.Util,n=this.element.value;t=a.copyDelimiter?n:r.stripDelimiters(n,a.delimiter,a.delimiters);try{e.clipboardData?e.clipboardData.setData("Text",t):window.clipboardData.setData("Text",t),e.preventDefault()}catch(e){}},onInput:function(e){var t=this,a=t.properties,r=v.Util,n=r.getPostDelimiter(e,a.delimiter,a.delimiters);return a.numeral||!a.postDelimiterBackspace||n||(e=r.headStr(e,e.length-a.postDelimiterBackspace.length)),a.phone?(!a.prefix||a.noImmediatePrefix&&!e.length?a.result=a.phoneFormatter.format(e):a.result=a.prefix+a.phoneFormatter.format(e).slice(a.prefix.length),void t.updateValueState()):a.numeral?(a.prefix&&a.noImmediatePrefix&&0===e.length?a.result="":a.result=a.numeralFormatter.format(e),void t.updateValueState()):(a.date&&(e=a.dateFormatter.getValidatedDate(e)),a.time&&(e=a.timeFormatter.getValidatedTime(e)),e=r.stripDelimiters(e,a.delimiter,a.delimiters),e=r.getPrefixStrippedValue(e,a.prefix,a.prefixLength,a.result,a.delimiter,a.delimiters,a.noImmediatePrefix,a.tailPrefix,a.signBeforePrefix),e=a.numericOnly?r.strip(e,/[^\d]/g):e,e=a.uppercase?e.toUpperCase():e,e=a.lowercase?e.toLowerCase():e,a.prefix&&(a.tailPrefix?e+=a.prefix:e=a.prefix+e,0===a.blocksLength)?(a.result=e,void t.updateValueState()):(a.creditCard&&t.updateCreditCardPropsByValue(e),e=r.headStr(e,a.maxLength),a.result=r.getFormattedValue(e,a.blocks,a.blocksLength,a.delimiter,a.delimiters,a.delimiterLazyShow),void t.updateValueState()))},updateCreditCardPropsByValue:function(e){var t,a=this.properties,r=v.Util;r.headStr(a.result,4)!==r.headStr(e,4)&&(t=v.CreditCardDetector.getInfo(e,a.creditCardStrictMode),a.blocks=t.blocks,a.blocksLength=a.blocks.length,a.maxLength=r.getMaxLength(a.blocks),a.creditCardType!==t.type&&(a.creditCardType=t.type,a.onCreditCardTypeChanged.call(this,a.creditCardType)))},updateValueState:function(){var e=this,t=v.Util,a=e.properties;if(e.element){var r=e.element.selectionEnd,n=e.element.value,i=a.result;r=t.getNextCursorPosition(r,n,i,a.delimiter,a.delimiters),e.isAndroid?window.setTimeout((function(){e.element.value=i,t.setSelection(e.element,r,a.document,!1),e.callOnValueChanged()}),1):(e.element.value=i,a.swapHiddenInput&&(e.elementSwapHidden.value=e.getRawValue()),t.setSelection(e.element,r,a.document,!1),e.callOnValueChanged())}},callOnValueChanged:function(){var e=this,t=e.properties;t.onValueChanged.call(e,{target:{name:e.element.name,value:t.result,rawValue:e.getRawValue()}})},setPhoneRegionCode:function(e){var t=this;t.properties.phoneRegionCode=e,t.initPhoneFormatter(),t.onChange()},setRawValue:function(e){var t=this,a=t.properties;e=null!=e?e.toString():"",a.numeral&&(e=e.replace(".",a.numeralDecimalMark)),a.postDelimiterBackspace=!1,t.element.value=e,t.onInput(e)},getRawValue:function(){var e=this.properties,t=v.Util,a=this.element.value;return e.rawValueTrimPrefix&&(a=t.getPrefixStrippedValue(a,e.prefix,e.prefixLength,e.result,e.delimiter,e.delimiters,e.noImmediatePrefix,e.tailPrefix,e.signBeforePrefix)),e.numeral?e.numeralFormatter.getRawValue(a):t.stripDelimiters(a,e.delimiter,e.delimiters)},getISOFormatDate:function(){var e=this.properties;return e.date?e.dateFormatter.getISOFormatDate():""},getISOFormatTime:function(){var e=this.properties;return e.time?e.timeFormatter.getISOFormatTime():""},getFormattedValue:function(){return this.element.value},destroy:function(){var e=this;e.element.removeEventListener("input",e.onChangeListener),e.element.removeEventListener("keydown",e.onKeyDownListener),e.element.removeEventListener("focus",e.onFocusListener),e.element.removeEventListener("cut",e.onCutListener),e.element.removeEventListener("copy",e.onCopyListener)},toString:function(){return"[Cleave Object]"}},v.NumeralFormatter=s,v.DateFormatter=d,v.TimeFormatter=u,v.PhoneFormatter=h,v.CreditCardDetector=g,v.Util=f,v.DefaultProperties=y,("object"==typeof i&&i?i:window).Cleave=v;const k=v;var b,w,S,x,L,E,F;!function(e){e.UGYFELEK_FORM="UgyfelekForm",e.UGYFELEK="Ugyfelek",e.REMOVE_UGYFEL="RemoveUgyfel",e[e.MAGAN=1]="MAGAN",e[e.CEG=2]="CEG"}(b||(b={}));class D extends r.h{url(e){return`/autok/ugyfelek/${e}`}async init(){const e=await this.ugyfelekGrid(this.div("ugyfelek-grid"));this.dataBound(e,(()=>{const t=e;t.autoFitColumn("email"),t.autoFitColumn("lakcim"),this.gridButtonList(t,"edit-btn").forEach((e=>{const a=e.data;e.button.onclick=async()=>{const e=await this.ugyfelekForm({id:a.id});this.message(e.message),t.dataSource.pushUpdate(e.model)}})),this.gridButtonList(t,"remove-btn").forEach((e=>{const a=e.data;e.button.onclick=async()=>{await this.confirm(t.wrapper[0].dataset.deleteConfirm,e.button);const r=this.url(b.REMOVE_UGYFEL),n=await this.fetchData(r,{id:a.id});this.message(n),t.dataSource.remove(a)}}))})),this.button("create-ugyfel-btn").onclick=async()=>{const t=await this.ugyfelekForm();this.message(t.message),e.dataSource.insert(0,t.model)}}async ugyfelekForm(e={}){const t=this.url(b.UGYFELEK_FORM),a=new n.h;a.root.innerHTML=await this.fetchData(t,e);const r=jQuery(this.input("ugyfelek-tipus")).kendoDropDownList({filter:"contains"}).data("kendoDropDownList");r.bind("change",(()=>{const e=this.div("ceg-data"),t=this.div("magan-data");e.classList.add("d-none"),t.classList.add("d-none");const a=parseInt(r.value());a==b.MAGAN&&t.classList.remove("d-none"),a==b.CEG&&e.classList.remove("d-none")})),r.trigger("change");const i=a.root.querySelector("button.save-btn");return new Promise((e=>{i.onclick=async()=>{const r=new FormData(a.form),n=await this.fetchForm(t,r,a.form,"ugyfelek");e(n),a.close()}}))}ugyfelekGrid(e){return new Promise((t=>{const a=this.url(b.UGYFELEK),r=this.schema,n=this.transport;n.read.url=a;const i=new kendo.data.DataSource({pageSize:100,transport:n,schema:r,serverPaging:!0,serverFiltering:!0}),o=ugyfelekColumns;jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},dataBound:e=>t(e.sender)})}))}}!function(e){e.AUTO_DETAIL="AutoDetail"}(w||(w={}));class I extends r.h{url(e){return`/index/${e}`}constructor(e){super(),this.autoId=0,this.popup=null,this.autoId=e}get carViewPopup(){return this.popup}async showDetail(e=!1){let t=this.url(w.AUTO_DETAIL);if(e){const e=new URL(t,window.location.origin);e.searchParams.set("admin","1"),t=e.toString()}const a=Math.min(1200,document.body.offsetWidth),r=new n.h("","",a);this.popup=r,r.root.innerHTML=await this.fetchData(t,{id:this.autoId}),document.querySelectorAll("section").forEach((e=>e.classList.add("blur"))),document.querySelectorAll("nav").forEach((e=>e.classList.add("blur")));const i=document.querySelector("div.form-popup-layer");i.style.cursor="pointer",i.onclick=()=>r.close();const o=window.scrollY+50;r.root.classList.add("fixed"),r.root.style.setProperty("--ypos",`${o}px`);const s=document.querySelectorAll(".simple-slider .slide");let l=0;s[l].classList.add("active");const d=this.div("thumb-slider"),c=this.div("counter-box");c.innerHTML=`1/${s.length}`;const u=e=>{s.forEach((e=>e.classList.remove("active"))),l=e,c.innerHTML=`${e+1}/${s.length}`,s[l].classList.add("active"),d.scrollTo({left:d.children[l].offsetLeft-d.offsetLeft,behavior:"smooth"})},m=this.button("prev-btn");this.button("next-btn").onclick=()=>u(Math.min(l+1,s.length-1)),m.onclick=()=>u(Math.max(l-1,0)),Array.from(d.querySelectorAll("div.thumb-slide")).forEach((e=>{e.onclick=()=>{const t=Array.from(e.parentElement.children).indexOf(e);u(t)}})),d.onwheel=e=>{0!==e.deltaY&&(e.preventDefault(),d.scrollLeft+=Math.trunc(e.deltaY))}}}!function(e){e.MARKAK="Markak",e.MARKAK_FORM="MarkakForm",e.REMOVE_MARKA="RemoveMarka"}(S||(S={}));class M extends r.h{url(e){return`/karbantartas/markak/${e}`}async init(){const e=await this.markakGrid(this.div("markak-grid"));this.dataBound(e,(()=>{const t=e;this.gridButtonList(t,"edit-btn").forEach((e=>{const a=e.data;e.button.onclick=async()=>{await this.markaForm({id:a.id}),t.dataSource.read()}})),this.gridButtonList(t,"remove-btn").forEach((e=>{const a=e.data;e.button.onclick=async()=>{await this.confirm(`Biztos törli a(z) ${a.name} márkát`,e.button),await this.fetchData(this.url(S.REMOVE_MARKA),{id:a.id}),t.dataSource.remove(e.data)}}))})),this.button("create-marka-btn").onclick=async()=>{await this.markaForm(),e.dataSource.read()}}async markaForm(e={}){const t=this.url(S.MARKAK_FORM),a=new n.h;a.root.innerHTML=await this.fetchData(t,e);const r=a.root.querySelector("button.save-btn");return new Promise((e=>{r.onclick=async()=>{const r=new FormData(a.form),n=await this.fetchForm(t,r,a.form,"markak");e(n),a.close()}}))}markakGrid(e){return new Promise((t=>{const a=this.url(S.MARKAK),r=this.schema,n=this.transport;n.read.url=a;const i=new kendo.data.DataSource({pageSize:100,transport:n,schema:r}),o=markakColumns;jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},dataBound:e=>t(e.sender)})}))}}!function(e){e.SZINEK="Szinek",e.SZINEK_FORM="SzinekForm",e.REMOVE_SZINEK="RemoveSzinek"}(x||(x={}));class T extends r.h{url(e){return`/karbantartas/szinek/${e}`}async init(){const e=await this.grid(this.div("grid"));this.dataBound(e,(()=>{this.gridButtonList(e,"edit-btn").forEach((t=>{const a=t.data;t.button.onclick=async()=>{const t=await this.form({id:a.id});e.dataSource.read(),this.message(t.message)}})),this.gridButtonList(e,"remove-btn").forEach((t=>{const a=t.data;t.button.onclick=async()=>{await this.confirm(`Biztos törli a(z) ${a.name} felszereltséget`,t.button);const r=await this.fetchData(this.url(x.REMOVE_SZINEK),{id:a.id});e.dataSource.remove(t.data),this.message(r)}}))})),this.button("create-btn").onclick=async()=>{const t=await this.form();e.dataSource.pushInsert(0,t.model),this.message(t.message)}}async form(e={}){const t=this.url(x.SZINEK_FORM),a=new n.h;a.root.innerHTML=await this.fetchData(t,e);const r=a.root.querySelector("button.save-btn");return new Promise((e=>{r.onclick=async()=>{const r=new FormData(a.form),n=await this.fetchForm(t,r,a.form,"szinek");e(n),await a.close()}}))}grid(e){return new Promise((t=>{const a=this.url(x.SZINEK),r=this.schema,n=this.transport;n.read.url=a;const i=new kendo.data.DataSource({pageSize:100,transport:n,schema:r}),o=gridColumns;jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},dataBound:e=>t(e.sender)})}))}}!function(e){e.KIVITEL="Kivitel",e.KIVITEL_FORM="KivitelForm",e.REMOVE_KIVITEL="RemoveKivitel"}(L||(L={}));class C extends r.h{url(e){return`/karbantartas/kivitel/${e}`}async init(){const e=await this.grid(this.div("grid"));this.dataBound(e,(()=>{this.gridButtonList(e,"edit-btn").forEach((t=>{const a=t.data;t.button.onclick=async()=>{const t=await this.form({id:a.id});e.dataSource.read(),this.message(t.message)}})),this.gridButtonList(e,"remove-btn").forEach((t=>{const a=t.data;t.button.onclick=async()=>{await this.confirm(`Biztos törli a(z) ${a.name} felszereltséget`,t.button);const r=await this.fetchData(this.url(L.REMOVE_KIVITEL),{id:a.id});e.dataSource.remove(t.data),this.message(r)}}))})),this.button("create-btn").onclick=async()=>{const t=await this.form();e.dataSource.pushInsert(0,t.model),this.message(t.message)}}async form(e={}){const t=this.url(L.KIVITEL_FORM),a=new n.h;a.root.innerHTML=await this.fetchData(t,e);const r=a.root.querySelector("button.save-btn");return new Promise((e=>{r.onclick=async()=>{const r=new FormData(a.form),n=await this.fetchForm(t,r,a.form,"kivitel");e(n),await a.close()}}))}grid(e){return new Promise((t=>{const a=this.url(L.KIVITEL),r=this.schema,n=this.transport;n.read.url=a;const i=new kendo.data.DataSource({pageSize:100,transport:n,schema:r}),o=gridColumns;jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},dataBound:e=>t(e.sender)})}))}}!function(e){e.FELSZERELTSEG="Felszereltseg",e.FELSZERELTSEG_FORM="FelszereltsegForm",e.REMOVE_FELSZERELTSEG="RemoveFelszereltseg"}(E||(E={}));class P extends r.h{url(e){return`/karbantartas/felszereltseg/${e}`}async init(){const e=await this.grid(this.div("grid"));this.dataBound(e,(()=>{this.gridButtonList(e,"edit-btn").forEach((t=>{const a=t.data;t.button.onclick=async()=>{const t=await this.form({id:a.id});e.dataSource.read(),this.message(t.message)}})),this.gridButtonList(e,"remove-btn").forEach((t=>{const a=t.data;t.button.onclick=async()=>{await this.confirm(`Biztos törli a(z) ${a.name} felszereltséget`,t.button);const r=await this.fetchData(this.url(E.REMOVE_FELSZERELTSEG),{id:a.id});e.dataSource.remove(t.data),this.message(r)}}))})),this.button("create-btn").onclick=async()=>{const t=await this.form();e.dataSource.pushInsert(0,t.model),this.message(t.message)}}async form(e={}){const t=this.url(E.FELSZERELTSEG_FORM),a=new n.h;a.root.innerHTML=await this.fetchData(t,e);const r=a.root.querySelector("button.save-btn");return new Promise((e=>{r.onclick=async()=>{const r=new FormData(a.form),n=await this.fetchForm(t,r,a.form,"felszereltseg");e(n),await a.close()}}))}grid(e){return new Promise((t=>{const a=this.url(E.FELSZERELTSEG),r=this.schema,n=this.transport;n.read.url=a;const i=new kendo.data.DataSource({pageSize:100,transport:n,schema:r}),o=gridColumns;jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},dataBound:e=>t(e.sender)})}))}}!function(e){e.AUTOK_FORM="AutokForm",e.AUTOK="Autok",e.REMOVE_AUTO="RemoveAuto",e.TIPUS_UPLOAD="upload",e.ELADVA_FORM="EladvaForm",e.DOKUMENTUMOK_DATASOURCE="DokumentumokDatasource",e.DETAIL="Detail"}(F||(F={}));class O extends r.h{async init(){const e=jQuery(this.div("grid-filter-selector")).kendoButtonGroup({index:parseInt(localStorage.getItem("grid-filter-selector")||"0"),rounded:"none"}).data("kendoButtonGroup"),t=jQuery(this.div("grid-status-filter-selector")).kendoButtonGroup({rounded:"none",index:parseInt(localStorage.getItem("grid-status-filter-selector")||"0")}).data("kendoButtonGroup"),a=await this.autokGrid(this.div("autok-grid"));this.dataBound(a,(()=>{const e=a;e.autoFitColumn("vetelar"),e.autoFitColumn("hirdetes_cime"),this.gridButtonList(e,"remove-btn").forEach((t=>{const a=t.data;t.button.disabled=1==a.eladva_int,t.button.onclick=async()=>{await this.confirm(a.confirm_text,t.button),(await this.fetchData(this.url(F.REMOVE_AUTO),{id:a.id})).success&&(e.dataSource.remove(a),this.message(a.delete_text))}})),this.gridButtonList(e,"edit-btn").forEach((t=>{const a=t.data;if(a.eladva_int){const e=t.button.querySelector("i"),r=document.createElement("i");r.classList.add("fa-solid","fa-database"),e.replaceWith(r),t.row.classList.add("eladva"),t.button.onclick=()=>{this.autoDetail({id:a.id})}}else t.button.onclick=async()=>{const t=await this.autoForm({id:a.id});e.dataSource.pushUpdate(t.model),e.dataSource.fetch(),this.message(a.edit_text)}})),this.gridButtonList(e,"eladva-btn").forEach((t=>{const a=t.data;t.button.disabled=1==a.eladva_int,t.button.onclick=async()=>{const t=await this.eladvaForm({id:a.id});this.message(t.message),e.dataSource.pushUpdate(t.model)}})),this.gridButtonList(e,"action-btn").forEach((t=>{const a=t.button.closest("td");let r=JSON.parse(a.dataset.muveletek);const n=t.data;1==n.eladva_int&&(r=r.filter((e=>"eladas"!=e.id)),t.row.classList.add("eladva")),t.row.querySelector("button.edit-btn");const i=async t=>{const a=new I(t);await a.showDetail(!0),this.button("auto-edit-btn").onclick=async()=>{const r=await this.autoForm({id:n.id});e.dataSource.pushUpdate(r.model),e.dataSource.fetch(),await(a.carViewPopup?.close()),await i(t)}};jQuery(t.button).kendoSplitButton({themeColor:"warning",items:r,click:async t=>{if(t.id){if("eladas"==t.id){const t=await this.eladvaForm({id:n.id});this.message(t.message),e.dataSource.pushUpdate(t.model)}"adatlap"==t.id&&await i(n.id)}}})}))}));const r=()=>{localStorage.setItem("grid-filter-selector",e.current().index().toString()),localStorage.setItem("grid-status-filter-selector",t.current().index().toString()),a.dataSource.transport.options.read.data.gridFilterSelector=e.current().index(),a.dataSource.transport.options.read.data.gridStatusFilterSelector=t.current().index(),a.dataSource.page(1)};e.bind("select",(()=>r())),t.bind("select",(()=>r())),r(),this.button("create-auto-btn").onclick=async()=>{const e=await this.autoForm();a.dataSource.pushInsert(0,e.model)}}async autoDetail(e={}){const t=this.url(F.DETAIL);(new n.h).root.innerHTML=await this.fetchData(t,e),jQuery(this.div("detail-tab")).kendoTabStrip({animation:!1}).data("kendoTabStrip").select(0)}async eladvaForm(e={}){const t=this.url(F.ELADVA_FORM),a=new n.h;a.root.innerHTML=await this.fetchData(t,e),["eladasmodel-eladas_datuma"].forEach((e=>{const t=document.getElementById(e);jQuery(t).kendoDatePicker({format:"yyyy-MM-dd"})}));const r=this.ugyfelekDataSource(),i=jQuery(this.input("eladasmodel-eladas_ugyfel_id")).kendoDropDownList({filter:"contains",height:400,dataSource:r,dataTextField:"nev",dataValueField:"id",optionLabel:"Kérem válasszon",autoBind:!1}).data("kendoDropDownList"),o=i.element[0].dataset.ugyfelId;o&&(i.dataSource.transport.options.read.data.ugyfelId=o,i.value(o)),i.dataSource.read(),this.button("ugyfel-letrehozasa-btn").onclick=async()=>{const e=new D,t=await e.ugyfelekForm();i.dataSource.pushInsert(0,t.model);const a=t.model;i.value(a.id)};const s=a.root.querySelector("button.save-btn");return new Promise((e=>{s.onclick=async()=>{await this.confirm(a.form.dataset.confirm||"",s);const r=new FormData(a.form),n=await this.fetchForm(t,r,a.form,"eladasmodel");e(n),a.close()}}))}ugyfelekDataSource(){const e=this.url(b.UGYFELEK),t=this.schema,a=this.transport;return a.read.url=e,new kendo.data.DataSource({pageSize:100,transport:a,schema:t,serverPaging:!0,serverFiltering:!0})}async autoForm(e={}){const t=this.url(F.AUTOK_FORM),a=Math.min(document.body.offsetWidth-120,1600),r=new n.h("","",a);r.root.innerHTML=await this.fetchData(t,e);const i=jQuery(this.div("form-tab")).kendoTabStrip({animation:!1}).data("kendoTabStrip");["autokmodel-ajtok_szam","autokmodel-szallithato_szemelyek","autokmodel-sajat_tomeg","autokmodel-ossztomeg","autokmodel-terhelhetoseg","autokmodel-tengelytav","autokmodel-hosszusag","autokmodel-szelesseg","autokmodel-hengerek_szama","autokmodel-hengerurtartalom"].forEach((e=>{const t=document.getElementById(e);jQuery(t).kendoNumericTextBox({format:"n0",decimals:0})})),["autokmodel-jarmutipus_id","autokmodel-marka_id","autokmodel-motortipus_id","autokmodel-valto_id","autokmodel-szinek_id","autokmodel-kivitel_id"].forEach((e=>{const t=document.getElementById(e);jQuery(t).kendoDropDownList({filter:"contains",height:400})})),["autokmodel-kilometer","autokmodel-teljesitmeny","autokmodel-vetelar","autokmodel-gyartasi_ev","autokmodel-akcios_ar"].forEach((e=>{const t=document.getElementById(e);new k(t,{numeral:!0,numeralThousandsGroupStyle:"thousand",delimiter:" ",numeralDecimalMark:",",numeralDecimalScale:0})})),["autokmodel-muszaki_ervenyes"].forEach((e=>{const t=document.getElementById(e);jQuery(t).kendoDatePicker({format:"yyyy-MM",depth:"year",start:"year"})}));const o=this.input("autokmodel-felszereltseg"),s=JSON.parse(o.dataset.felszereltsegIdList);jQuery(o).kendoMultiSelect({clearButton:!0,height:400,autoClose:!1,highlightFirst:!0,downArrow:!1,filter:"contains",value:s}),i.select(0);const l=await this.dokumentumokGrid(this.div("dokumentumok-grid"));this.dataBound(l,(()=>{const e=l;this.gridButtonList(e,"remove-btn").forEach((t=>{const a=t.data;t.button.onclick=async()=>{await this.confirm(t.button.parentElement.dataset.deleteText||"",t.button),e.dataSource.remove(a)}})),this.gridButtonList(e,"view-btn").forEach((e=>{const t=e.data;e.button.disabled=!t.id,e.button.onclick=()=>{this.navigate(t.dokumentumUrl,"_blank")}}))}));let d=i.wrapper[0].querySelector("div.k-tabstrip-content.k-active");const c=this.div("upload-kepek-box");new ResizeObserver((()=>{d=i.wrapper[0].querySelector("div.k-tabstrip-content.k-active"),c.style.height=`${d.offsetHeight}px`})).observe(d);const u=this.div("akcios-ar-box"),m=this.input("autokmodel-akcios");m.onchange=()=>m.checked?u.classList.remove("d-none"):u.classList.add("d-none"),m.dispatchEvent(new Event("change"));const h=this.input("autokmodel-dokumentumok");h.onchange=()=>{const e=h.files;Array.from(e).forEach((e=>{const t=e.name.substring(0,e.name.lastIndexOf(".")),a={extension:e.name.substring(e.name.lastIndexOf(".")+1),name:t,uploadName:e.name,file:e};l.dataSource.insert(0,a)})),h.value=""};const p=this.input("autokmodel-image");c.dataset.images&&(JSON.parse(c.dataset.images).forEach((e=>{this.imageBox(c,e.name,e.image).dataset.id=e.id})),this.showOrder(c),this.sortImages(c)),p.onchange=()=>{const e=p.files;if(e){const t=new MutationObserver((()=>{const a=Array.from(c.children),r=a.reduce(((e,t)=>(t.dataset.tipus==F.TIPUS_UPLOAD&&e++,e)),0);e.length==r&&(a.forEach((e=>e.removeAttribute("data-tipus"))),this.showOrder(c),t.disconnect())}));t.observe(c,{childList:!0});for(let t=0;t<e.length;t++){const a=e[t],r=new FileReader;r.onload=e=>{this.imageBox(c,a.name,e.target?.result).dataset.tipus=F.TIPUS_UPLOAD},r.readAsDataURL(a)}this.sortImages(c)}};const g=this.button("marka-hozzaad-btn");g.onclick=async()=>{const e=jQuery(g.parentElement.querySelector("select")).data("kendoDropDownList"),t=await(new M).markaForm();e.dataSource.add({value:t.model.id,text:t.model.name}),e.select(e.dataSource.data().length-1)};const f=this.button("szin-hozzaad-btn");f.onclick=async()=>{const e=jQuery(f.parentElement.querySelector("select")).data("kendoDropDownList"),t=await(new T).form();e.dataSource.add({value:t.model.id,text:t.model.szin_neve}),e.select(e.dataSource.data().length-1)};const y=this.button("kivitel-hozzaad-btn");y.onclick=async()=>{const e=jQuery(y.parentElement.querySelector("select")).data("kendoDropDownList"),t=await(new C).form();e.dataSource.add({value:t.model.id,text:t.model.name}),e.select(e.dataSource.data().length-1)};const v=this.button("felszereltseg-hozzaad-btn");v.onclick=async()=>{const e=jQuery(v.parentElement.querySelector("select")).data("kendoMultiSelect"),t=await(new P).form();e.dataSource.add({value:t.model.id,text:t.model.name}),e.value(e.value().concat([t.model.id]))};const b=r.root.querySelector("button.save-btn");return new Promise((e=>{b.onclick=async()=>{const a=new FormData(r.form),n=Array.from(c.children).map(((e,t)=>({index:t+1,name:e.dataset.name,id:e.dataset.id})));a.append("sorrend",JSON.stringify(n));const i=l.dataSource.data().toJSON();a.append("dokumentumok",JSON.stringify(i)),l.dataSource.data().map((e=>e.file)).forEach(((e,t)=>{a.append(`dokumetumokFiles[${t}]`,e)}));const o=await this.fetchForm(t,a,r.form,"autokmodel");e(o),r.close()}}))}dokumentumokGrid(e){return new Promise((t=>{const a=this.url(F.DOKUMENTUMOK_DATASOURCE),r=this.schema;r.model={id:"id",fields:{extension:{editable:!1}}};const n=this.transport;n.read.url=a,n.read.data.autokId=e.dataset.autokId;const i=new kendo.data.DataSource({pageSize:100,transport:n,schema:r}),o=dokumentumokColumns;jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:800,pageable:{refresh:!1},editable:!0,dataBound:e=>t(e.sender),navigatable:!0})}))}sortImages(e){jQuery(e).kendoSortable({filter:".image-item-box",cursor:"move",cursorOffset:{top:-80,left:-100},hint:e=>{const t=e.clone().css({width:"200px",maxWidth:"200px",height:"160px"}).addClass("drag-hint");return t.find("img").css({width:"100%",height:"100%",objectFit:"cover",display:"block"}),t},placeholder:e=>e.clone().css({opacity:.3,width:"200px",height:"160px"}).addClass("placeholder").text("IDE JÖHET"),change:()=>this.showOrder(e)})}showOrder(e){e.querySelectorAll("div.image-item-box:not(.placeholder)").forEach(((e,t)=>{const a=e.querySelector("div.order-box");a&&(a.innerHTML=(t+1).toString())}))}imageBox(e,t,a){const r=document.createElement("div");r.classList.add("image-item-box"),r.dataset.name=t;const n=document.createElement("img"),i=document.createElement("div");i.classList.add("order-box"),n.src=a;const o=document.createElement("div");return o.innerHTML='<i class="fa-solid fa-trash-can"></i>',o.classList.add("remove-box"),r.appendChild(n),r.appendChild(i),r.appendChild(o),e.appendChild(r),o.onclick=async()=>{await this.confirm("Biztosan törli a képet?",o),r.remove(),this.showOrder(e)},r}autokGrid(e){return new Promise((t=>{const a=this.url(F.AUTOK),r=this.schema,n=this.transport;n.read.url=a;const i=new kendo.data.DataSource({pageSize:100,transport:n,schema:r,serverPaging:!0,serverFiltering:!0,serverSorting:!0}),o=autokColumns,s=JSON.parse(e.dataset.markakFilter),l=JSON.parse(e.dataset.vetelarFilter),d=[];for(const[e,t]of Object.entries(l))d.push({id:e,value:t});o.find((e=>"vetelar"==e.field)).template=e=>`${kendo.toString(parseInt(e.vetelar),"n0")} Ft`,["publikalva","akcios","eladva","fooldalra"].forEach((t=>{o.find((e=>e.field==t)).filterable={ui:t=>{this.igenNemFilter(t,e)}}})),o.find((e=>"marka"==e.field)).filterable={operators:{string:{eq:e.dataset.egyenlo}},ui:e=>{jQuery(e).kendoDropDownList({filter:"contains",optionLabel:"----------",height:400,dataSource:{data:s}})}},o.find((e=>"vetelar"==e.field)).filterable={operators:{string:{eq:e.dataset.egyenlo}},ui:e=>{jQuery(e).kendoDropDownList({filter:"contains",optionLabel:"----------",height:400,dataValueField:"id",dataTextField:"value",dataSource:{data:d}})}},o.find((e=>"azonosito"==e.field)).template=e=>0==e.edit?`${e.azonosito}`:`<div class="edited-box"><span>${e.azonosito}</span><span><i class="fa-solid fa-user-pen"></i></span></div>`,t(jQuery(e).kendoGrid({columns:o,dataSource:i,filterable:this.filterable,height:"100%",pageable:{refresh:!0},autoBind:!1,sortable:!0}).data("kendoGrid"))}))}}(new O).init()})();