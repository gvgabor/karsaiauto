(()=>{"use strict";var e={169:(e,t,r)=>{r.d(t,{h:()=>i});var a=r(725);class i extends a.h{constructor(e="Karsai autó",t="",r=800){super(),this.prev=document.querySelector("div.form-popup"),this.prev&&this.prev.classList.add("back"),this.root=document.createElement("div"),this.root.classList.add("form-popup"),this.root.style.width=`${r}px`,this.root.style.zIndex=`${this.maxZIndex+1}`,this.layer=document.createElement("div"),this.layer.classList.add("form-popup-layer"),document.body.appendChild(this.layer),this.layer.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(this.root),this.root.style.zIndex=(this.maxZIndex+1).toString();const a=new MutationObserver((()=>{const e=this.root.querySelector("div.close-box");e&&(e.onclick=()=>this.close(),e.style.cursor="pointer",this.form=this.root.querySelector("form"),a.disconnect()),requestAnimationFrame((()=>this.root.classList.add("active")))}));a.observe(this.root,{childList:!0})}close(){return new Promise((e=>{this.root.ontransitionend=t=>{"top"!=t.propertyName&&"border-bottom-color"!=t.propertyName||(this.root.remove(),this.layer.remove(),e(),this.prev&&this.prev.classList.remove("back"))},this.root.classList.remove("active")}))}}},725:(e,t,r)=>{r.d(t,{h:()=>a});class a{url(e){return`${(window.location.origin+window.location.pathname).replace(/\/+$/,"")}/${e}`}get schema(){return{model:{id:"id",fields:{}},data:e=>e.data||[],total:e=>e.total||0}}input(e){return document.getElementById(e)??document.createElement("button")}message(e){const t=Array.from(document.querySelectorAll("div.message-box")).reduce((e=>e+90),50),r=document.createElement("div");r.classList.add("message-box");const a=(new Date).toLocaleTimeString("hu-HU",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1});r.style.zIndex=(this.maxZIndex+1).toString(),r.innerHTML=e+"&nbsp;"+a,r.style.top=`${t}px`,document.body.appendChild(r),r.ontransitionend=()=>{},requestAnimationFrame((()=>r.classList.add("active"))),r.onclick=()=>{r.ontransitionend=()=>r.remove(),r.classList.remove("active")},setTimeout((()=>{r.ontransitionend=()=>r.remove(),r.classList.remove("active")}),3e3)}showFormError(e,t,r){t.querySelectorAll("div.error-box").forEach((e=>e.remove()));for(const[a,i]of Object.entries(r)){const r=t.querySelector(`div.field-${e}-${a}`);console.log({model:e,key:a});const n=document.createElement("div");n.classList.add("error-box"),n.style.zIndex=(this.maxZIndex+1).toString(),n.innerHTML=i[0],r&&(r.appendChild(n),requestAnimationFrame((()=>n.classList.add("show"))))}}gridButtonList(e,t){return Array.from(e.wrapper[0].querySelectorAll(`button.${t}`)).map((t=>{const r=t.closest("tr");return{button:t,row:r,data:e.dataItem(r)}}))}async fetchDelete(e,t){const r=await fetch(`${e}/${t}`,{method:"DELETE",headers:{"X-Requested-With":"XMLHttpRequest","X-CSRF-Token":yii.getCsrfToken()}});let a;try{a=await r.json()}catch(e){a=null}if(200==r.status)return a;throw new Error(a?.message||"Sikertelen törlés")}async fetchForm(e,t,r=null,a=null,i=!0){return new Promise((n=>{const o=Array.from(document.querySelectorAll("div.form-popup"));if(o){const e=document.createElement("div");e.classList.add("loader"),e.style.zIndex=(this.maxZIndex+1).toString(),e.innerHTML='˛<img alt="nincs" src="/images/YTup.gif">',o[o.length-1]?.appendChild(e)}const s=[200,201,202],l=document.createElement("div");let d;i&&(l.classList.add("popup-layer"),document.body.appendChild(l),l.classList.add("animate"),l.style.zIndex=(this.maxZIndex+1).toString()),t.append("_csrf",yii.getCsrfToken()),fetch(e,{method:"POST",body:t}).then((e=>{if(l&&(l.remove(),document.querySelectorAll("div.loader").forEach((e=>e.remove()))),d=e.status,(e.headers.get("Content-Type")||"").includes("application/json"))return e.json();throw new Error("A válasz nem JSON formátumú.")})).then((e=>{s.includes(d)?n(e):a&&r&&this.showFormError(a,r,e.errors)}))}))}async fetchData(e,t={},r=!0){const a=jQuery.Deferred(),i=new FormData,n=document.createElement("div");r&&(n.classList.add("popup-layer"),n.style.zIndex=(this.maxZIndex+1).toString(),document.body.appendChild(n),n.classList.add("animate")),i.append("_csrf",yii.getCsrfToken());for(const[e,r]of Object.entries(t))i.append(e,r);const o=await fetch(e,{headers:{"X-Requested-With":"XMLHttpRequest"},body:i,method:"POST"});if(403==o.status)return alert(await o.text()),document.querySelectorAll("div.form-popup-layer").forEach((e=>e.remove())),document.querySelectorAll("div.form-popup").forEach((e=>e.remove())),n&&n.remove(),!1;let s;const l=o.headers.get("content-type");return s="string"==typeof l&&l.includes("application/json")?await o.json():await o.text(),n&&n.remove(),a.resolve(s),a}urlPart(e){return`${new URL(window.location.href).pathname}/${e}`}get transport(){const e={};return e._csrf=yii.getCsrfToken(),{read:{type:"POST",url:null,data:e,dataType:"json"}}}confirm(e,t){const r=jQuery.Deferred(),a=jQuery(t).kendoPopover({body:()=>`<div class="confirm-body"><div>${e}</div><div><button class="btn btn-primary btn" data-name="no-btn">Nem</button><button class="btn btn-danger btn" data-name="yes-btn">Igen</button></div></div>`,position:"left",header:()=>"Megerősítés",showOn:"click",show:e=>{const t=e.sender.popup.element?.[0]?.querySelector('button[data-name="no-btn"]');t&&(t.onclick=()=>{e.sender.hide()});const a=e.sender.popup.element?.[0]?.querySelector('button[data-name="yes-btn"]');a&&(a.onclick=()=>{r.resolve(),e.sender.hide()})},hide:()=>{document.body.querySelectorAll("div.confirm-body").forEach((e=>{e.closest("div.k-animation-container")?.remove()}))}}).data("kendoPopover");return a&&a.show(),r}button(e){return document.getElementById(e)}div(e){return document.getElementById(e)}async delete(e,t){const r=new URL(window.location.origin+"/"+this.pascalToKebab(e));r.searchParams.append("id",t.toString());try{const e=await fetch(r.toString(),{method:"DELETE",headers:{"X-CSRF-Token":yii.getCsrfToken(),Accept:"application/json"}}),t=await e.json();return e.ok||console.error("Hiba a válaszban:",t.message||"Ismeretlen hiba történt."),t}catch(e){throw console.error("DELETE hiba:",e.message),e}}get maxZIndex(){let e=0;const t=document.getElementsByTagName("*");for(let r=0;r<t.length;r++){const a=window.getComputedStyle(t[r]).zIndex,i=parseInt(a,10);isNaN(i)||(e=Math.max(e,i))}return e}navigate(e,t="_self"){const r=document.createElement("a");r.href=e,document.body.appendChild(r),r.target=t,r.click(),r.remove()}pascalToKebab(e){return e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}grid(e,t,r=!0,a=[]){return new Promise((i=>{const n=this.schema,o=this.transport;o.read.url=t;const s=new kendo.data.DataSource({pageSize:100,transport:o,schema:n}),l=jQuery(e).kendoGrid({columns:a,dataSource:s,filterable:this.filterable,height:"100%",pageable:{refresh:!0},autoBind:r}).data("kendoGrid");if(!l)throw new Error("Failed to initialize kendoGrid.");r?l.bind("dataBound",(()=>i(l))):i(l)}))}igenNemFilter(e,t){jQuery(e).kendoDropDownList({dataValueField:"id",dataTextField:"value",optionLabel:"-----------",dataSource:new kendo.data.DataSource({data:JSON.parse(t.dataset.igennemFilter)})})}get filterable(){return{extra:!1,operators:{string:{contains:"Tartalmazza",eq:"Egyenlő"}}}}dataBound(e,t,r=!0){e.bind("dataBound",t),r&&t()}}}},t={};function r(a){var i=t[a];if(void 0!==i)return i.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,r),n.exports}r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a=r(725),i=r(169),n="undefined"!=typeof window?window:void 0!==r.g?r.g:"undefined"!=typeof self?self:{},o=function(e,t,r,a,i,n,s,l,d,c){var u=this;u.numeralDecimalMark=e||".",u.numeralIntegerScale=t>0?t:0,u.numeralDecimalScale=r>=0?r:2,u.numeralThousandsGroupStyle=a||o.groupStyle.thousand,u.numeralPositiveOnly=!!i,u.stripLeadingZeroes=!1!==n,u.prefix=s||""===s?s:"",u.signBeforePrefix=!!l,u.tailPrefix=!!d,u.delimiter=c||""===c?c:",",u.delimiterRE=c?new RegExp("\\"+c,"g"):""};o.groupStyle={thousand:"thousand",lakh:"lakh",wan:"wan",none:"none"},o.prototype={getRawValue:function(e){return e.replace(this.delimiterRE,"").replace(this.numeralDecimalMark,".")},format:function(e){var t,r,a,i,n=this,s="";switch(e=e.replace(/[A-Za-z]/g,"").replace(n.numeralDecimalMark,"M").replace(/[^\dM-]/g,"").replace(/^\-/,"N").replace(/\-/g,"").replace("N",n.numeralPositiveOnly?"":"-").replace("M",n.numeralDecimalMark),n.stripLeadingZeroes&&(e=e.replace(/^(-)?0+(?=\d)/,"$1")),r="-"===e.slice(0,1)?"-":"",a=void 0!==n.prefix?n.signBeforePrefix?r+n.prefix:n.prefix+r:r,i=e,e.indexOf(n.numeralDecimalMark)>=0&&(i=(t=e.split(n.numeralDecimalMark))[0],s=n.numeralDecimalMark+t[1].slice(0,n.numeralDecimalScale)),"-"===r&&(i=i.slice(1)),n.numeralIntegerScale>0&&(i=i.slice(0,n.numeralIntegerScale)),n.numeralThousandsGroupStyle){case o.groupStyle.lakh:i=i.replace(/(\d)(?=(\d\d)+\d$)/g,"$1"+n.delimiter);break;case o.groupStyle.wan:i=i.replace(/(\d)(?=(\d{4})+$)/g,"$1"+n.delimiter);break;case o.groupStyle.thousand:i=i.replace(/(\d)(?=(\d{3})+$)/g,"$1"+n.delimiter)}return n.tailPrefix?r+i.toString()+(n.numeralDecimalScale>0?s.toString():"")+n.prefix:a+i.toString()+(n.numeralDecimalScale>0?s.toString():"")}};var s=o,l=function(e,t,r){var a=this;a.date=[],a.blocks=[],a.datePattern=e,a.dateMin=t.split("-").reverse().map((function(e){return parseInt(e,10)})),2===a.dateMin.length&&a.dateMin.unshift(0),a.dateMax=r.split("-").reverse().map((function(e){return parseInt(e,10)})),2===a.dateMax.length&&a.dateMax.unshift(0),a.initBlocks()};l.prototype={initBlocks:function(){var e=this;e.datePattern.forEach((function(t){"Y"===t?e.blocks.push(4):e.blocks.push(2)}))},getISOFormatDate:function(){var e=this,t=e.date;return t[2]?t[2]+"-"+e.addLeadingZero(t[1])+"-"+e.addLeadingZero(t[0]):""},getBlocks:function(){return this.blocks},getValidatedDate:function(e){var t=this,r="";return e=e.replace(/[^\d]/g,""),t.blocks.forEach((function(a,i){if(e.length>0){var n=e.slice(0,a),o=n.slice(0,1),s=e.slice(a);switch(t.datePattern[i]){case"d":"00"===n?n="01":parseInt(o,10)>3?n="0"+o:parseInt(n,10)>31&&(n="31");break;case"m":"00"===n?n="01":parseInt(o,10)>1?n="0"+o:parseInt(n,10)>12&&(n="12")}r+=n,e=s}})),this.getFixedDateString(r)},getFixedDateString:function(e){var t,r,a,i=this,n=i.datePattern,o=[],s=0,l=0,d=0,c=0,u=0,m=0,h=!1;return 4===e.length&&"y"!==n[0].toLowerCase()&&"y"!==n[1].toLowerCase()&&(u=2-(c="d"===n[0]?0:2),t=parseInt(e.slice(c,c+2),10),r=parseInt(e.slice(u,u+2),10),o=this.getFixedDate(t,r,0)),8===e.length&&(n.forEach((function(e,t){switch(e){case"d":s=t;break;case"m":l=t;break;default:d=t}})),m=2*d,c=s<=d?2*s:2*s+2,u=l<=d?2*l:2*l+2,t=parseInt(e.slice(c,c+2),10),r=parseInt(e.slice(u,u+2),10),a=parseInt(e.slice(m,m+4),10),h=4===e.slice(m,m+4).length,o=this.getFixedDate(t,r,a)),4!==e.length||"y"!==n[0]&&"y"!==n[1]||(m=2-(u="m"===n[0]?0:2),r=parseInt(e.slice(u,u+2),10),a=parseInt(e.slice(m,m+2),10),h=2===e.slice(m,m+2).length,o=[0,r,a]),6!==e.length||"Y"!==n[0]&&"Y"!==n[1]||(m=2-.5*(u="m"===n[0]?0:4),r=parseInt(e.slice(u,u+2),10),a=parseInt(e.slice(m,m+4),10),h=4===e.slice(m,m+4).length,o=[0,r,a]),o=i.getRangeFixedDate(o),i.date=o,0===o.length?e:n.reduce((function(e,t){switch(t){case"d":return e+(0===o[0]?"":i.addLeadingZero(o[0]));case"m":return e+(0===o[1]?"":i.addLeadingZero(o[1]));case"y":return e+(h?i.addLeadingZeroForYear(o[2],!1):"");case"Y":return e+(h?i.addLeadingZeroForYear(o[2],!0):"")}}),"")},getRangeFixedDate:function(e){var t=this,r=t.datePattern,a=t.dateMin||[],i=t.dateMax||[];return!e.length||a.length<3&&i.length<3||r.find((function(e){return"y"===e.toLowerCase()}))&&0===e[2]?e:i.length&&(i[2]<e[2]||i[2]===e[2]&&(i[1]<e[1]||i[1]===e[1]&&i[0]<e[0]))?i:a.length&&(a[2]>e[2]||a[2]===e[2]&&(a[1]>e[1]||a[1]===e[1]&&a[0]>e[0]))?a:e},getFixedDate:function(e,t,r){return e=Math.min(e,31),t=Math.min(t,12),r=parseInt(r||0,10),(t<7&&t%2==0||t>8&&t%2==1)&&(e=Math.min(e,2===t?this.isLeapYear(r)?29:28:30)),[e,t,r]},isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},addLeadingZero:function(e){return(e<10?"0":"")+e},addLeadingZeroForYear:function(e,t){return t?(e<10?"000":e<100?"00":e<1e3?"0":"")+e:(e<10?"0":"")+e}};var d=l,c=function(e,t){var r=this;r.time=[],r.blocks=[],r.timePattern=e,r.timeFormat=t,r.initBlocks()};c.prototype={initBlocks:function(){var e=this;e.timePattern.forEach((function(){e.blocks.push(2)}))},getISOFormatTime:function(){var e=this,t=e.time;return t[2]?e.addLeadingZero(t[0])+":"+e.addLeadingZero(t[1])+":"+e.addLeadingZero(t[2]):""},getBlocks:function(){return this.blocks},getTimeFormatOptions:function(){return"12"===String(this.timeFormat)?{maxHourFirstDigit:1,maxHours:12,maxMinutesFirstDigit:5,maxMinutes:60}:{maxHourFirstDigit:2,maxHours:23,maxMinutesFirstDigit:5,maxMinutes:60}},getValidatedTime:function(e){var t=this,r="";e=e.replace(/[^\d]/g,"");var a=t.getTimeFormatOptions();return t.blocks.forEach((function(i,n){if(e.length>0){var o=e.slice(0,i),s=o.slice(0,1),l=e.slice(i);switch(t.timePattern[n]){case"h":parseInt(s,10)>a.maxHourFirstDigit?o="0"+s:parseInt(o,10)>a.maxHours&&(o=a.maxHours+"");break;case"m":case"s":parseInt(s,10)>a.maxMinutesFirstDigit?o="0"+s:parseInt(o,10)>a.maxMinutes&&(o=a.maxMinutes+"")}r+=o,e=l}})),this.getFixedTimeString(r)},getFixedTimeString:function(e){var t,r,a,i=this,n=i.timePattern,o=[],s=0,l=0,d=0,c=0,u=0,m=0;return 6===e.length&&(n.forEach((function(e,t){switch(e){case"s":s=2*t;break;case"m":l=2*t;break;case"h":d=2*t}})),m=d,u=l,c=s,t=parseInt(e.slice(c,c+2),10),r=parseInt(e.slice(u,u+2),10),a=parseInt(e.slice(m,m+2),10),o=this.getFixedTime(a,r,t)),4===e.length&&i.timePattern.indexOf("s")<0&&(n.forEach((function(e,t){switch(e){case"m":l=2*t;break;case"h":d=2*t}})),m=d,u=l,t=0,r=parseInt(e.slice(u,u+2),10),a=parseInt(e.slice(m,m+2),10),o=this.getFixedTime(a,r,t)),i.time=o,0===o.length?e:n.reduce((function(e,t){switch(t){case"s":return e+i.addLeadingZero(o[2]);case"m":return e+i.addLeadingZero(o[1]);case"h":return e+i.addLeadingZero(o[0])}}),"")},getFixedTime:function(e,t,r){return r=Math.min(parseInt(r||0,10),60),t=Math.min(t,60),[e=Math.min(e,60),t,r]},addLeadingZero:function(e){return(e<10?"0":"")+e}};var u=c,m=function(e,t){var r=this;r.delimiter=t||""===t?t:" ",r.delimiterRE=t?new RegExp("\\"+t,"g"):"",r.formatter=e};m.prototype={setFormatter:function(e){this.formatter=e},format:function(e){var t=this;t.formatter.clear();for(var r,a="",i=!1,n=0,o=(e=(e=(e=e.replace(/[^\d+]/g,"")).replace(/^\+/,"B").replace(/\+/g,"").replace("B","+")).replace(t.delimiterRE,"")).length;n<o;n++)r=t.formatter.inputDigit(e.charAt(n)),/[\s()-]/g.test(r)?(a=r,i=!0):i||(a=r);return(a=a.replace(/[()]/g,"")).replace(/[\s-]/g,t.delimiter)}};var h=m,p={blocks:{uatp:[4,5,6],amex:[4,6,5],diners:[4,6,4],discover:[4,4,4,4],mastercard:[4,4,4,4],dankort:[4,4,4,4],instapayment:[4,4,4,4],jcb15:[4,6,5],jcb:[4,4,4,4],maestro:[4,4,4,4],visa:[4,4,4,4],mir:[4,4,4,4],unionPay:[4,4,4,4],general:[4,4,4,4]},re:{uatp:/^(?!1800)1\d{0,14}/,amex:/^3[47]\d{0,13}/,discover:/^(?:6011|65\d{0,2}|64[4-9]\d?)\d{0,12}/,diners:/^3(?:0([0-5]|9)|[689]\d?)\d{0,11}/,mastercard:/^(5[1-5]\d{0,2}|22[2-9]\d{0,1}|2[3-7]\d{0,2})\d{0,12}/,dankort:/^(5019|4175|4571)\d{0,12}/,instapayment:/^63[7-9]\d{0,13}/,jcb15:/^(?:2131|1800)\d{0,11}/,jcb:/^(?:35\d{0,2})\d{0,12}/,maestro:/^(?:5[0678]\d{0,2}|6304|67\d{0,2})\d{0,12}/,mir:/^220[0-4]\d{0,12}/,visa:/^4\d{0,15}/,unionPay:/^(62|81)\d{0,14}/},getStrictBlocks:function(e){var t=e.reduce((function(e,t){return e+t}),0);return e.concat(19-t)},getInfo:function(e,t){var r=p.blocks,a=p.re;for(var i in t=!!t,a)if(a[i].test(e)){var n=r[i];return{type:i,blocks:t?this.getStrictBlocks(n):n}}return{type:"unknown",blocks:t?this.getStrictBlocks(r.general):r.general}}},g=p,f={noop:function(){},strip:function(e,t){return e.replace(t,"")},getPostDelimiter:function(e,t,r){if(0===r.length)return e.slice(-t.length)===t?t:"";var a="";return r.forEach((function(t){e.slice(-t.length)===t&&(a=t)})),a},getDelimiterREByDelimiter:function(e){return new RegExp(e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),"g")},getNextCursorPosition:function(e,t,r,a,i){return t.length===e?r.length:e+this.getPositionOffset(e,t,r,a,i)},getPositionOffset:function(e,t,r,a,i){var n,o,s;return n=this.stripDelimiters(t.slice(0,e),a,i),o=this.stripDelimiters(r.slice(0,e),a,i),0!==(s=n.length-o.length)?s/Math.abs(s):0},stripDelimiters:function(e,t,r){var a=this;if(0===r.length){var i=t?a.getDelimiterREByDelimiter(t):"";return e.replace(i,"")}return r.forEach((function(t){t.split("").forEach((function(t){e=e.replace(a.getDelimiterREByDelimiter(t),"")}))})),e},headStr:function(e,t){return e.slice(0,t)},getMaxLength:function(e){return e.reduce((function(e,t){return e+t}),0)},getPrefixStrippedValue:function(e,t,r,a,i,n,o,s,l){if(0===r)return e;if(e===t&&""!==e)return"";if(l&&"-"==e.slice(0,1)){var d="-"==a.slice(0,1)?a.slice(1):a;return"-"+this.getPrefixStrippedValue(e.slice(1),t,r,d,i,n,o,s,l)}if(a.slice(0,r)!==t&&!s)return o&&!a&&e?e:"";if(a.slice(-r)!==t&&s)return o&&!a&&e?e:"";var c=this.stripDelimiters(a,i,n);return e.slice(0,r)===t||s?e.slice(-r)!==t&&s?c.slice(0,-r-1):s?e.slice(0,-r):e.slice(r):c.slice(r)},getFirstDiffIndex:function(e,t){for(var r=0;e.charAt(r)===t.charAt(r);)if(""===e.charAt(r++))return-1;return r},getFormattedValue:function(e,t,r,a,i,n){var o="",s=i.length>0,l="";return 0===r?e:(t.forEach((function(t,d){if(e.length>0){var c=e.slice(0,t),u=e.slice(t);l=s?i[n?d-1:d]||l:a,n?(d>0&&(o+=l),o+=c):(o+=c,c.length===t&&d<r-1&&(o+=l)),e=u}})),o)},fixPrefixCursor:function(e,t,r,a){if(e){var i=e.value,n=r||a[0]||" ";if(e.setSelectionRange&&t&&!(t.length+n.length<=i.length)){var o=2*i.length;setTimeout((function(){e.setSelectionRange(o,o)}),1)}}},checkFullSelection:function(e){try{return(window.getSelection()||document.getSelection()||{}).toString().length===e.length}catch(e){}return!1},setSelection:function(e,t,r){if(e===this.getActiveElement(r)&&!(e&&e.value.length<=t))if(e.createTextRange){var a=e.createTextRange();a.move("character",t),a.select()}else try{e.setSelectionRange(t,t)}catch(e){console.warn("The input element type does not support selection")}},getActiveElement:function(e){var t=e.activeElement;return t&&t.shadowRoot?this.getActiveElement(t.shadowRoot):t},isAndroid:function(){return navigator&&/android/i.test(navigator.userAgent)},isAndroidBackspaceKeydown:function(e,t){return!!(this.isAndroid()&&e&&t)&&t===e.slice(0,-1)}},v={assign:function(e,t){return t=t||{},(e=e||{}).creditCard=!!t.creditCard,e.creditCardStrictMode=!!t.creditCardStrictMode,e.creditCardType="",e.onCreditCardTypeChanged=t.onCreditCardTypeChanged||function(){},e.phone=!!t.phone,e.phoneRegionCode=t.phoneRegionCode||"AU",e.phoneFormatter={},e.time=!!t.time,e.timePattern=t.timePattern||["h","m","s"],e.timeFormat=t.timeFormat||"24",e.timeFormatter={},e.date=!!t.date,e.datePattern=t.datePattern||["d","m","Y"],e.dateMin=t.dateMin||"",e.dateMax=t.dateMax||"",e.dateFormatter={},e.numeral=!!t.numeral,e.numeralIntegerScale=t.numeralIntegerScale>0?t.numeralIntegerScale:0,e.numeralDecimalScale=t.numeralDecimalScale>=0?t.numeralDecimalScale:2,e.numeralDecimalMark=t.numeralDecimalMark||".",e.numeralThousandsGroupStyle=t.numeralThousandsGroupStyle||"thousand",e.numeralPositiveOnly=!!t.numeralPositiveOnly,e.stripLeadingZeroes=!1!==t.stripLeadingZeroes,e.signBeforePrefix=!!t.signBeforePrefix,e.tailPrefix=!!t.tailPrefix,e.swapHiddenInput=!!t.swapHiddenInput,e.numericOnly=e.creditCard||e.date||!!t.numericOnly,e.uppercase=!!t.uppercase,e.lowercase=!!t.lowercase,e.prefix=e.creditCard||e.date?"":t.prefix||"",e.noImmediatePrefix=!!t.noImmediatePrefix,e.prefixLength=e.prefix.length,e.rawValueTrimPrefix=!!t.rawValueTrimPrefix,e.copyDelimiter=!!t.copyDelimiter,e.initValue=void 0!==t.initValue&&null!==t.initValue?t.initValue.toString():"",e.delimiter=t.delimiter||""===t.delimiter?t.delimiter:t.date?"/":t.time?":":t.numeral?",":(t.phone," "),e.delimiterLength=e.delimiter.length,e.delimiterLazyShow=!!t.delimiterLazyShow,e.delimiters=t.delimiters||[],e.blocks=t.blocks||[],e.blocksLength=e.blocks.length,e.root="object"==typeof n&&n?n:window,e.document=t.document||e.root.document,e.maxLength=0,e.backspace=!1,e.result="",e.onValueChanged=t.onValueChanged||function(){},e}},y=function(e,t){var r=this,a=!1;if("string"==typeof e?(r.element=document.querySelector(e),a=document.querySelectorAll(e).length>1):void 0!==e.length&&e.length>0?(r.element=e[0],a=e.length>1):r.element=e,!r.element)throw new Error("[cleave.js] Please check the element");if(a)try{console.warn("[cleave.js] Multiple input fields matched, cleave.js will only take the first one.")}catch(e){}t.initValue=r.element.value,r.properties=y.DefaultProperties.assign({},t),r.init()};y.prototype={init:function(){var e=this,t=e.properties;t.numeral||t.phone||t.creditCard||t.time||t.date||0!==t.blocksLength||t.prefix?(t.maxLength=y.Util.getMaxLength(t.blocks),e.isAndroid=y.Util.isAndroid(),e.lastInputValue="",e.isBackward="",e.onChangeListener=e.onChange.bind(e),e.onKeyDownListener=e.onKeyDown.bind(e),e.onFocusListener=e.onFocus.bind(e),e.onCutListener=e.onCut.bind(e),e.onCopyListener=e.onCopy.bind(e),e.initSwapHiddenInput(),e.element.addEventListener("input",e.onChangeListener),e.element.addEventListener("keydown",e.onKeyDownListener),e.element.addEventListener("focus",e.onFocusListener),e.element.addEventListener("cut",e.onCutListener),e.element.addEventListener("copy",e.onCopyListener),e.initPhoneFormatter(),e.initDateFormatter(),e.initTimeFormatter(),e.initNumeralFormatter(),(t.initValue||t.prefix&&!t.noImmediatePrefix)&&e.onInput(t.initValue)):e.onInput(t.initValue)},initSwapHiddenInput:function(){var e=this;if(e.properties.swapHiddenInput){var t=e.element.cloneNode(!0);e.element.parentNode.insertBefore(t,e.element),e.elementSwapHidden=e.element,e.elementSwapHidden.type="hidden",e.element=t,e.element.id=""}},initNumeralFormatter:function(){var e=this.properties;e.numeral&&(e.numeralFormatter=new y.NumeralFormatter(e.numeralDecimalMark,e.numeralIntegerScale,e.numeralDecimalScale,e.numeralThousandsGroupStyle,e.numeralPositiveOnly,e.stripLeadingZeroes,e.prefix,e.signBeforePrefix,e.tailPrefix,e.delimiter))},initTimeFormatter:function(){var e=this.properties;e.time&&(e.timeFormatter=new y.TimeFormatter(e.timePattern,e.timeFormat),e.blocks=e.timeFormatter.getBlocks(),e.blocksLength=e.blocks.length,e.maxLength=y.Util.getMaxLength(e.blocks))},initDateFormatter:function(){var e=this.properties;e.date&&(e.dateFormatter=new y.DateFormatter(e.datePattern,e.dateMin,e.dateMax),e.blocks=e.dateFormatter.getBlocks(),e.blocksLength=e.blocks.length,e.maxLength=y.Util.getMaxLength(e.blocks))},initPhoneFormatter:function(){var e=this.properties;if(e.phone)try{e.phoneFormatter=new y.PhoneFormatter(new e.root.Cleave.AsYouTypeFormatter(e.phoneRegionCode),e.delimiter)}catch(e){throw new Error("[cleave.js] Please include phone-type-formatter.{country}.js lib")}},onKeyDown:function(e){var t=this,r=e.which||e.keyCode;t.lastInputValue=t.element.value,t.isBackward=8===r},onChange:function(e){var t=this,r=t.properties,a=y.Util;t.isBackward=t.isBackward||"deleteContentBackward"===e.inputType;var i=a.getPostDelimiter(t.lastInputValue,r.delimiter,r.delimiters);t.isBackward&&i?r.postDelimiterBackspace=i:r.postDelimiterBackspace=!1,this.onInput(this.element.value)},onFocus:function(){var e=this,t=e.properties;e.lastInputValue=e.element.value,t.prefix&&t.noImmediatePrefix&&!e.element.value&&this.onInput(t.prefix),y.Util.fixPrefixCursor(e.element,t.prefix,t.delimiter,t.delimiters)},onCut:function(e){y.Util.checkFullSelection(this.element.value)&&(this.copyClipboardData(e),this.onInput(""))},onCopy:function(e){y.Util.checkFullSelection(this.element.value)&&this.copyClipboardData(e)},copyClipboardData:function(e){var t,r=this.properties,a=y.Util,i=this.element.value;t=r.copyDelimiter?i:a.stripDelimiters(i,r.delimiter,r.delimiters);try{e.clipboardData?e.clipboardData.setData("Text",t):window.clipboardData.setData("Text",t),e.preventDefault()}catch(e){}},onInput:function(e){var t=this,r=t.properties,a=y.Util,i=a.getPostDelimiter(e,r.delimiter,r.delimiters);return r.numeral||!r.postDelimiterBackspace||i||(e=a.headStr(e,e.length-r.postDelimiterBackspace.length)),r.phone?(!r.prefix||r.noImmediatePrefix&&!e.length?r.result=r.phoneFormatter.format(e):r.result=r.prefix+r.phoneFormatter.format(e).slice(r.prefix.length),void t.updateValueState()):r.numeral?(r.prefix&&r.noImmediatePrefix&&0===e.length?r.result="":r.result=r.numeralFormatter.format(e),void t.updateValueState()):(r.date&&(e=r.dateFormatter.getValidatedDate(e)),r.time&&(e=r.timeFormatter.getValidatedTime(e)),e=a.stripDelimiters(e,r.delimiter,r.delimiters),e=a.getPrefixStrippedValue(e,r.prefix,r.prefixLength,r.result,r.delimiter,r.delimiters,r.noImmediatePrefix,r.tailPrefix,r.signBeforePrefix),e=r.numericOnly?a.strip(e,/[^\d]/g):e,e=r.uppercase?e.toUpperCase():e,e=r.lowercase?e.toLowerCase():e,r.prefix&&(r.tailPrefix?e+=r.prefix:e=r.prefix+e,0===r.blocksLength)?(r.result=e,void t.updateValueState()):(r.creditCard&&t.updateCreditCardPropsByValue(e),e=a.headStr(e,r.maxLength),r.result=a.getFormattedValue(e,r.blocks,r.blocksLength,r.delimiter,r.delimiters,r.delimiterLazyShow),void t.updateValueState()))},updateCreditCardPropsByValue:function(e){var t,r=this.properties,a=y.Util;a.headStr(r.result,4)!==a.headStr(e,4)&&(t=y.CreditCardDetector.getInfo(e,r.creditCardStrictMode),r.blocks=t.blocks,r.blocksLength=r.blocks.length,r.maxLength=a.getMaxLength(r.blocks),r.creditCardType!==t.type&&(r.creditCardType=t.type,r.onCreditCardTypeChanged.call(this,r.creditCardType)))},updateValueState:function(){var e=this,t=y.Util,r=e.properties;if(e.element){var a=e.element.selectionEnd,i=e.element.value,n=r.result;a=t.getNextCursorPosition(a,i,n,r.delimiter,r.delimiters),e.isAndroid?window.setTimeout((function(){e.element.value=n,t.setSelection(e.element,a,r.document,!1),e.callOnValueChanged()}),1):(e.element.value=n,r.swapHiddenInput&&(e.elementSwapHidden.value=e.getRawValue()),t.setSelection(e.element,a,r.document,!1),e.callOnValueChanged())}},callOnValueChanged:function(){var e=this,t=e.properties;t.onValueChanged.call(e,{target:{name:e.element.name,value:t.result,rawValue:e.getRawValue()}})},setPhoneRegionCode:function(e){var t=this;t.properties.phoneRegionCode=e,t.initPhoneFormatter(),t.onChange()},setRawValue:function(e){var t=this,r=t.properties;e=null!=e?e.toString():"",r.numeral&&(e=e.replace(".",r.numeralDecimalMark)),r.postDelimiterBackspace=!1,t.element.value=e,t.onInput(e)},getRawValue:function(){var e=this.properties,t=y.Util,r=this.element.value;return e.rawValueTrimPrefix&&(r=t.getPrefixStrippedValue(r,e.prefix,e.prefixLength,e.result,e.delimiter,e.delimiters,e.noImmediatePrefix,e.tailPrefix,e.signBeforePrefix)),e.numeral?e.numeralFormatter.getRawValue(r):t.stripDelimiters(r,e.delimiter,e.delimiters)},getISOFormatDate:function(){var e=this.properties;return e.date?e.dateFormatter.getISOFormatDate():""},getISOFormatTime:function(){var e=this.properties;return e.time?e.timeFormatter.getISOFormatTime():""},getFormattedValue:function(){return this.element.value},destroy:function(){var e=this;e.element.removeEventListener("input",e.onChangeListener),e.element.removeEventListener("keydown",e.onKeyDownListener),e.element.removeEventListener("focus",e.onFocusListener),e.element.removeEventListener("cut",e.onCutListener),e.element.removeEventListener("copy",e.onCopyListener)},toString:function(){return"[Cleave Object]"}},y.NumeralFormatter=s,y.DateFormatter=d,y.TimeFormatter=u,y.PhoneFormatter=h,y.CreditCardDetector=g,y.Util=f,y.DefaultProperties=v,("object"==typeof n&&n?n:window).Cleave=y;const k=y;var b,w,x;!function(e){e.UGYFELEK_FORM="UgyfelekForm",e.UGYFELEK="Ugyfelek",e.REMOVE_UGYFEL="RemoveUgyfel",e[e.MAGAN=1]="MAGAN",e[e.CEG=2]="CEG"}(b||(b={}));class S extends a.h{url(e){return`/autok/ugyfelek/${e}`}async init(){const e=await this.ugyfelekGrid(this.div("ugyfelek-grid"));this.dataBound(e,(()=>{const t=e;t.autoFitColumn("email"),t.autoFitColumn("lakcim"),this.gridButtonList(t,"edit-btn").forEach((e=>{const r=e.data;e.button.onclick=async()=>{const e=await this.ugyfelekForm({id:r.id});this.message(e.message),t.dataSource.pushUpdate(e.model)}})),this.gridButtonList(t,"remove-btn").forEach((e=>{const r=e.data;e.button.onclick=async()=>{await this.confirm(t.wrapper[0].dataset.deleteConfirm,e.button);const a=this.url(b.REMOVE_UGYFEL),i=await this.fetchData(a,{id:r.id});this.message(i),t.dataSource.remove(r)}}))})),this.button("create-ugyfel-btn").onclick=async()=>{const t=await this.ugyfelekForm();this.message(t.message),e.dataSource.insert(0,t.model)}}async ugyfelekForm(e={}){const t=this.url(b.UGYFELEK_FORM),r=new i.h;r.root.innerHTML=await this.fetchData(t,e);const a=jQuery(this.input("ugyfelek-tipus")).kendoDropDownList({filter:"contains"}).data("kendoDropDownList");a.bind("change",(()=>{const e=this.div("ceg-data"),t=this.div("magan-data");e.classList.add("d-none"),t.classList.add("d-none");const r=parseInt(a.value());r==b.MAGAN&&t.classList.remove("d-none"),r==b.CEG&&e.classList.remove("d-none")})),a.trigger("change");const n=r.root.querySelector("button.save-btn");return new Promise((e=>{n.onclick=async()=>{const a=new FormData(r.form),i=await this.fetchForm(t,a,r.form,"ugyfelek");e(i),r.close()}}))}ugyfelekGrid(e){return new Promise((t=>{const r=this.url(b.UGYFELEK),a=this.schema,i=this.transport;i.read.url=r;const n=new kendo.data.DataSource({pageSize:100,transport:i,schema:a,serverPaging:!0,serverFiltering:!0}),o=ugyfelekColumns;jQuery(e).kendoGrid({columns:o,dataSource:n,filterable:this.filterable,height:"100%",pageable:{refresh:!0},dataBound:e=>t(e.sender)})}))}}!function(e){e.AUTO_DETAIL="AutoDetail"}(w||(w={}));class L extends a.h{url(e){return`/index/${e}`}constructor(e){super(),this.autoId=0,this.popup=null,this.autoId=e}get carViewPopup(){return this.popup}async showDetail(e=!1){let t=this.url(w.AUTO_DETAIL);if(e){const e=new URL(t,window.location.origin);e.searchParams.set("admin","1"),t=e.toString()}const r=Math.min(1200,document.body.offsetWidth),a=new i.h("","",r);this.popup=a,a.root.innerHTML=await this.fetchData(t,{id:this.autoId});const n=document.querySelector("div.form-popup-layer");n.style.cursor="pointer",n.onclick=()=>a.close();const o=window.scrollY+50;a.root.classList.add("fixed"),a.root.style.setProperty("--ypos",`${o}px`);const s=document.querySelectorAll(".simple-slider .slide");let l=0;s[l].classList.add("active");const d=this.div("thumb-slider"),c=this.div("counter-box");c.innerHTML=`1/${s.length}`;const u=e=>{s.forEach((e=>e.classList.remove("active"))),l=e,c.innerHTML=`${e+1}/${s.length}`,s[l].classList.add("active"),d.scrollTo({left:d.children[l].offsetLeft-d.offsetLeft,behavior:"smooth"})},m=this.button("prev-btn");this.button("next-btn").onclick=()=>u(Math.min(l+1,s.length-1)),m.onclick=()=>u(Math.max(l-1,0)),Array.from(d.querySelectorAll("div.thumb-slide")).forEach((e=>{e.onclick=()=>{const t=Array.from(e.parentElement.children).indexOf(e);u(t)}})),d.onwheel=e=>{0!==e.deltaY&&(e.preventDefault(),d.scrollLeft+=Math.trunc(e.deltaY))}}}!function(e){e.AUTOK_FORM="AutokForm",e.AUTOK="Autok",e.REMOVE_AUTO="RemoveAuto",e.TIPUS_UPLOAD="upload",e.ELADVA_FORM="EladvaForm",e.DOKUMENTUMOK_DATASOURCE="DokumentumokDatasource",e.DETAIL="Detail"}(x||(x={}));class D extends a.h{async init(){const e=jQuery(this.div("grid-filter-selector")).kendoButtonGroup({index:parseInt(localStorage.getItem("grid-filter-selector")||"0"),rounded:"none"}).data("kendoButtonGroup"),t=jQuery(this.div("grid-status-filter-selector")).kendoButtonGroup({rounded:"none",index:parseInt(localStorage.getItem("grid-status-filter-selector")||"0")}).data("kendoButtonGroup"),r=await this.autokGrid(this.div("autok-grid"));this.dataBound(r,(()=>{const e=r;e.autoFitColumn("vetelar"),this.gridButtonList(e,"remove-btn").forEach((t=>{const r=t.data;t.button.disabled=1==r.eladva_int,t.button.onclick=async()=>{await this.confirm(r.confirm_text,t.button),(await this.fetchData(this.url(x.REMOVE_AUTO),{id:r.id})).success&&(e.dataSource.remove(r),this.message(r.delete_text))}})),this.gridButtonList(e,"edit-btn").forEach((t=>{const r=t.data;if(r.eladva_int){const e=t.button.querySelector("i"),a=document.createElement("i");a.classList.add("fa-solid","fa-database"),e.replaceWith(a),t.row.classList.add("eladva"),t.button.onclick=()=>{this.autoDetail({id:r.id})}}else t.button.onclick=async()=>{const t=await this.autoForm({id:r.id});e.dataSource.pushUpdate(t.model),e.dataSource.fetch(),this.message(r.edit_text)}})),this.gridButtonList(e,"eladva-btn").forEach((t=>{const r=t.data;t.button.disabled=1==r.eladva_int,t.button.onclick=async()=>{const t=await this.eladvaForm({id:r.id});this.message(t.message),e.dataSource.pushUpdate(t.model)}})),this.gridButtonList(e,"action-btn").forEach((t=>{const r=t.button.closest("td");let a=JSON.parse(r.dataset.muveletek);const i=t.data;1==i.eladva_int&&(a=a.filter((e=>"eladas"!=e.id)),t.row.classList.add("eladva")),t.row.querySelector("button.edit-btn");const n=async t=>{const r=new L(t);await r.showDetail(!0),this.button("auto-edit-btn").onclick=async()=>{const a=await this.autoForm({id:i.id});e.dataSource.pushUpdate(a.model),e.dataSource.fetch(),await(r.carViewPopup?.close()),await n(t)}};jQuery(t.button).kendoSplitButton({themeColor:"warning",items:a,click:async t=>{if(t.id){if("eladas"==t.id){const t=await this.eladvaForm({id:i.id});this.message(t.message),e.dataSource.pushUpdate(t.model)}"adatlap"==t.id&&await n(i.id)}}})}))}));const a=()=>{localStorage.setItem("grid-filter-selector",e.current().index().toString()),localStorage.setItem("grid-status-filter-selector",t.current().index().toString()),r.dataSource.transport.options.read.data.gridFilterSelector=e.current().index(),r.dataSource.transport.options.read.data.gridStatusFilterSelector=t.current().index(),r.dataSource.page(1)};e.bind("select",(()=>a())),t.bind("select",(()=>a())),a(),this.button("create-auto-btn").onclick=async()=>{const e=await this.autoForm();r.dataSource.pushInsert(0,e.model)}}async autoDetail(e={}){const t=this.url(x.DETAIL);(new i.h).root.innerHTML=await this.fetchData(t,e),jQuery(this.div("detail-tab")).kendoTabStrip({animation:!1}).data("kendoTabStrip").select(0)}async eladvaForm(e={}){const t=this.url(x.ELADVA_FORM),r=new i.h;r.root.innerHTML=await this.fetchData(t,e),["eladasmodel-eladas_datuma"].forEach((e=>{const t=document.getElementById(e);jQuery(t).kendoDatePicker({format:"yyyy-MM-dd"})}));const a=this.ugyfelekDataSource(),n=jQuery(this.input("eladasmodel-eladas_ugyfel_id")).kendoDropDownList({filter:"contains",height:400,dataSource:a,dataTextField:"nev",dataValueField:"id",optionLabel:"Kérem válasszon",autoBind:!1}).data("kendoDropDownList"),o=n.element[0].dataset.ugyfelId;o&&(n.dataSource.transport.options.read.data.ugyfelId=o,n.value(o)),n.dataSource.read(),this.button("ugyfel-letrehozasa-btn").onclick=async()=>{const e=new S,t=await e.ugyfelekForm();n.dataSource.pushInsert(0,t.model);const r=t.model;n.value(r.id)};const s=r.root.querySelector("button.save-btn");return new Promise((e=>{s.onclick=async()=>{await this.confirm(r.form.dataset.confirm||"",s);const a=new FormData(r.form),i=await this.fetchForm(t,a,r.form,"eladasmodel");e(i),r.close()}}))}ugyfelekDataSource(){const e=this.url(b.UGYFELEK),t=this.schema,r=this.transport;return r.read.url=e,new kendo.data.DataSource({pageSize:100,transport:r,schema:t,serverPaging:!0,serverFiltering:!0})}async autoForm(e={}){const t=this.url(x.AUTOK_FORM),r=Math.min(document.body.offsetWidth-120,1600),a=new i.h("","",r);a.root.innerHTML=await this.fetchData(t,e);const n=jQuery(this.div("form-tab")).kendoTabStrip({animation:!1}).data("kendoTabStrip");["autokmodel-jarmutipus_id","autokmodel-marka_id","autokmodel-motortipus_id","autokmodel-valto_id"].forEach((e=>{const t=document.getElementById(e);jQuery(t).kendoDropDownList({filter:"contains"})})),["autokmodel-kilometer","autokmodel-teljesitmeny","autokmodel-vetelar","autokmodel-gyartasi_ev","autokmodel-akcios_ar"].forEach((e=>{const t=document.getElementById(e);new k(t,{numeral:!0,numeralThousandsGroupStyle:"thousand",delimiter:" ",numeralDecimalMark:",",numeralDecimalScale:0})})),["autokmodel-muszaki_ervenyes"].forEach((e=>{const t=document.getElementById(e);jQuery(t).kendoDatePicker({format:"yyyy-MM",depth:"year",start:"year"})})),n.select(0);const o=await this.dokumentumokGrid(this.div("dokumentumok-grid"));this.dataBound(o,(()=>{const e=o;this.gridButtonList(e,"remove-btn").forEach((t=>{const r=t.data;t.button.onclick=async()=>{await this.confirm(t.button.parentElement.dataset.deleteText||"",t.button),e.dataSource.remove(r)}})),this.gridButtonList(e,"view-btn").forEach((e=>{const t=e.data;e.button.disabled=!t.id,e.button.onclick=()=>{this.navigate(t.dokumentumUrl,"_blank")}}))}));let s=n.wrapper[0].querySelector("div.k-tabstrip-content.k-active");const l=this.div("upload-kepek-box");new ResizeObserver((()=>{s=n.wrapper[0].querySelector("div.k-tabstrip-content.k-active"),l.style.height=`${s.offsetHeight}px`})).observe(s);const d=this.div("akcios-ar-box"),c=this.input("autokmodel-akcios");c.onchange=()=>c.checked?d.classList.remove("d-none"):d.classList.add("d-none"),c.dispatchEvent(new Event("change"));const u=this.input("autokmodel-dokumentumok");u.onchange=()=>{const e=u.files;Array.from(e).forEach((e=>{const t=e.name.substring(0,e.name.lastIndexOf(".")),r={extension:e.name.substring(e.name.lastIndexOf(".")+1),name:t,uploadName:e.name,file:e};o.dataSource.insert(0,r)})),u.value=""};const m=this.input("autokmodel-image");l.dataset.images&&(JSON.parse(l.dataset.images).forEach((e=>{this.imageBox(l,e.name,e.image).dataset.id=e.id})),this.showOrder(l),this.sortImages(l)),m.onchange=()=>{const e=m.files;if(e){const t=new MutationObserver((()=>{const r=Array.from(l.children),a=r.reduce(((e,t)=>(t.dataset.tipus==x.TIPUS_UPLOAD&&e++,e)),0);e.length==a&&(r.forEach((e=>e.removeAttribute("data-tipus"))),this.showOrder(l),t.disconnect())}));t.observe(l,{childList:!0});for(let t=0;t<e.length;t++){const r=e[t],a=new FileReader;a.onload=e=>{this.imageBox(l,r.name,e.target?.result).dataset.tipus=x.TIPUS_UPLOAD},a.readAsDataURL(r)}this.sortImages(l)}};const h=a.root.querySelector("button.save-btn");return new Promise((e=>{h.onclick=async()=>{const r=new FormData(a.form),i=Array.from(l.children).map(((e,t)=>({index:t+1,name:e.dataset.name,id:e.dataset.id})));r.append("sorrend",JSON.stringify(i));const n=o.dataSource.data().toJSON();r.append("dokumentumok",JSON.stringify(n)),o.dataSource.data().map((e=>e.file)).forEach(((e,t)=>{r.append(`dokumetumokFiles[${t}]`,e)}));const s=await this.fetchForm(t,r,a.form,"autokmodel");e(s),a.close()}}))}dokumentumokGrid(e){return new Promise((t=>{const r=this.url(x.DOKUMENTUMOK_DATASOURCE),a=this.schema;a.model={id:"id",fields:{extension:{editable:!1}}};const i=this.transport;i.read.url=r,i.read.data.autokId=e.dataset.autokId;const n=new kendo.data.DataSource({pageSize:100,transport:i,schema:a}),o=dokumentumokColumns;jQuery(e).kendoGrid({columns:o,dataSource:n,filterable:this.filterable,height:800,pageable:{refresh:!1},editable:!0,dataBound:e=>t(e.sender),navigatable:!0})}))}sortImages(e){jQuery(e).kendoSortable({filter:".image-item-box",cursor:"move",cursorOffset:{top:-80,left:-100},hint:e=>{const t=e.clone().css({width:"200px",maxWidth:"200px",height:"160px"}).addClass("drag-hint");return t.find("img").css({width:"100%",height:"100%",objectFit:"cover",display:"block"}),t},placeholder:e=>e.clone().css({opacity:.3,width:"200px",height:"160px"}).addClass("placeholder").text("IDE JÖHET"),change:()=>this.showOrder(e)})}showOrder(e){e.querySelectorAll("div.image-item-box:not(.placeholder)").forEach(((e,t)=>{const r=e.querySelector("div.order-box");r&&(r.innerHTML=(t+1).toString())}))}imageBox(e,t,r){const a=document.createElement("div");a.classList.add("image-item-box"),a.dataset.name=t;const i=document.createElement("img"),n=document.createElement("div");n.classList.add("order-box"),i.src=r;const o=document.createElement("div");return o.innerHTML='<i class="fa-solid fa-trash-can"></i>',o.classList.add("remove-box"),a.appendChild(i),a.appendChild(n),a.appendChild(o),e.appendChild(a),o.onclick=async()=>{await this.confirm("Biztosan törli a képet?",o),a.remove(),this.showOrder(e)},a}autokGrid(e){return new Promise((t=>{const r=this.url(x.AUTOK),a=this.schema,i=this.transport;i.read.url=r;const n=new kendo.data.DataSource({pageSize:100,transport:i,schema:a,serverPaging:!0,serverFiltering:!0,serverSorting:!0}),o=autokColumns,s=JSON.parse(e.dataset.markakFilter),l=JSON.parse(e.dataset.vetelarFilter),d=[];for(const[e,t]of Object.entries(l))d.push({id:e,value:t});o.find((e=>"vetelar"==e.field)).template=e=>`${kendo.toString(parseInt(e.vetelar),"n0")} Ft`,["publikalva","akcios","eladva","fooldalra"].forEach((t=>{o.find((e=>e.field==t)).filterable={ui:t=>{this.igenNemFilter(t,e)}}})),o.find((e=>"marka"==e.field)).filterable={operators:{string:{eq:e.dataset.egyenlo}},ui:e=>{jQuery(e).kendoDropDownList({filter:"contains",optionLabel:"----------",height:400,dataSource:{data:s}})}},o.find((e=>"vetelar"==e.field)).filterable={operators:{string:{eq:e.dataset.egyenlo}},ui:e=>{jQuery(e).kendoDropDownList({filter:"contains",optionLabel:"----------",height:400,dataValueField:"id",dataTextField:"value",dataSource:{data:d}})}},o.find((e=>"hirdetes_cime"==e.field)).template=e=>0==e.edit?`${e.hirdetes_cime}`:`<div class="edited-box"><span>${e.hirdetes_cime}</span><span><i class="fa-solid fa-user-pen"></i></span></div>`,t(jQuery(e).kendoGrid({columns:o,dataSource:n,filterable:this.filterable,height:"100%",pageable:{refresh:!0},autoBind:!1,sortable:!0}).data("kendoGrid"))}))}}(new D).init()})();